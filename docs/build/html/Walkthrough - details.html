
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>More detailed walkthrough &#8212; PyDDM v0.1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=d47532a6"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Walkthrough - details';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Creating a new DDM fitting function" href="Walkthrough%20-%20creating%20a%20new%20DDM%20fitting%20function.html" />
    <link rel="prev" title="Simple walkthrough" href="Walkthrough%20-%20simple.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">PyDDM v0.1.0 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="usage.html">Usage</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Provide_info_for_analysis.html">What metadata to provide in the YAML file</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="Walkthrough%20-%20simple.html">Basic walkthrough</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Advanced walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="Walkthrough%20-%20creating%20a%20new%20DDM%20fitting%20function.html">Adding a new DDM model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Walkthrough%20-%20intermittent%20dynamics.html">Probing intermittent dynamics</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="_autosummary/PyDDM.html">PyDDM</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="_autosummary/PyDDM.ISF_and_DDMmatrix_theoretical_models.html">PyDDM.ISF_and_DDMmatrix_theoretical_models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryBallistic_DDM.html">PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryBallistic_DDM</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryBallistic_ISF.html">PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryBallistic_ISF</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryDoubleExp_DDM.html">PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryDoubleExp_DDM</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryDoubleExp_ISF.html">PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryDoubleExp_ISF</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryDoubleExp_OneNonerg_ISF.html">PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryDoubleExp_OneNonerg_ISF</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryExpAndBallistic_DDM.html">PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryExpAndBallistic_DDM</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryExpAndBallistic_ISF.html">PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryExpAndBallistic_ISF</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryPolydisperse_DDM.html">PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryPolydisperse_DDM</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheorySingleExp_DDM.html">PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheorySingleExp_DDM</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheorySingleExp_ISF.html">PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheorySingleExp_ISF</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheorySingleExp_Nonerg_DDM.html">PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheorySingleExp_Nonerg_DDM</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheorySingleExp_Nonerg_ISF.html">PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheorySingleExp_Nonerg_ISF</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryTwoBallistic_DDM.html">PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryTwoBallistic_DDM</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryTwoBallistic_ISF.html">PyDDM.ISF_and_DDMmatrix_theoretical_models.dTheoryTwoBallistic_ISF</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="_autosummary/PyDDM.dcimg_mod.html">PyDDM.dcimg_mod</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.dcimg_mod.DCIMGFile.html">PyDDM.dcimg_mod.DCIMGFile</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="_autosummary/PyDDM.ddm_analysis_and_fitting.html">PyDDM.ddm_analysis_and_fitting</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_analysis_and_fitting.apply_binning.html">PyDDM.ddm_analysis_and_fitting.apply_binning</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_analysis_and_fitting.fit_report.html">PyDDM.ddm_analysis_and_fitting.fit_report</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_analysis_and_fitting.get_tau_vs_q_fit.html">PyDDM.ddm_analysis_and_fitting.get_tau_vs_q_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_analysis_and_fitting.interactive_fit_inspection.html">PyDDM.ddm_analysis_and_fitting.interactive_fit_inspection</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_analysis_and_fitting.newt.html">PyDDM.ddm_analysis_and_fitting.newt</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_analysis_and_fitting.print_fitting_models.html">PyDDM.ddm_analysis_and_fitting.print_fitting_models</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_analysis_and_fitting.recalculate_ISF_with_new_background.html">PyDDM.ddm_analysis_and_fitting.recalculate_ISF_with_new_background</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_analysis_and_fitting.save_fit_results_to_excel.html">PyDDM.ddm_analysis_and_fitting.save_fit_results_to_excel</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_analysis_and_fitting.Browse_DDM_Fits.html">PyDDM.ddm_analysis_and_fitting.Browse_DDM_Fits</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_analysis_and_fitting.DDM_Analysis.html">PyDDM.ddm_analysis_and_fitting.DDM_Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_analysis_and_fitting.DDM_Fit.html">PyDDM.ddm_analysis_and_fitting.DDM_Fit</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.html">PyDDM.ddm_calc</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.computeDDMMatrix.html">PyDDM.ddm_calc.computeDDMMatrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.computeDDMMatrix_correctVelocityPhase.html">PyDDM.ddm_calc.computeDDMMatrix_correctVelocityPhase</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.determining_A_and_B.html">PyDDM.ddm_calc.determining_A_and_B</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.execute_LSQ_fit.html">PyDDM.ddm_calc.execute_LSQ_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.execute_ScipyCurveFit_fit.html">PyDDM.ddm_calc.execute_ScipyCurveFit_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.find_radial_average.html">PyDDM.ddm_calc.find_radial_average</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.fit_ddm.html">PyDDM.ddm_calc.fit_ddm</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.fit_ddm_all_qs.html">PyDDM.ddm_calc.fit_ddm_all_qs</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.generateLogDistributionOfTimeLags.html">PyDDM.ddm_calc.generateLogDistributionOfTimeLags</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.generate_mask.html">PyDDM.ddm_calc.generate_mask</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.getPhase_phiDM.html">PyDDM.ddm_calc.getPhase_phiDM</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.getVel_phiDM.html">PyDDM.ddm_calc.getVel_phiDM</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.get_FF_DDM_matrix.html">PyDDM.ddm_calc.get_FF_DDM_matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.get_MSD_from_DDM_data.html">PyDDM.ddm_calc.get_MSD_from_DDM_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.newt.html">PyDDM.ddm_calc.newt</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.radial_avg_ddm_matrix.html">PyDDM.ddm_calc.radial_avg_ddm_matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.temporalVarianceDDMMatrix.html">PyDDM.ddm_calc.temporalVarianceDDMMatrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.window_function.html">PyDDM.ddm_calc.window_function</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.ddm_calc.IPythonStreamHandler.html">PyDDM.ddm_calc.IPythonStreamHandler</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="_autosummary/PyDDM.fit_parameters_dictionaries.html">PyDDM.fit_parameters_dictionaries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.fit_parameters_dictionaries.extract_array_of_fixed_or_not.html">PyDDM.fit_parameters_dictionaries.extract_array_of_fixed_or_not</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.fit_parameters_dictionaries.extract_array_of_param_mins_maxes.html">PyDDM.fit_parameters_dictionaries.extract_array_of_param_mins_maxes</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.fit_parameters_dictionaries.extract_array_of_parameter_values.html">PyDDM.fit_parameters_dictionaries.extract_array_of_parameter_values</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.fit_parameters_dictionaries.populate_intial_guesses.html">PyDDM.fit_parameters_dictionaries.populate_intial_guesses</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.fit_parameters_dictionaries.populate_min_and_max_of_paramters.html">PyDDM.fit_parameters_dictionaries.populate_min_and_max_of_paramters</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.fit_parameters_dictionaries.return_parameter_names.html">PyDDM.fit_parameters_dictionaries.return_parameter_names</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.fit_parameters_dictionaries.return_possible_fitting_models.html">PyDDM.fit_parameters_dictionaries.return_possible_fitting_models</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.fit_parameters_dictionaries.set_parameter_fixed.html">PyDDM.fit_parameters_dictionaries.set_parameter_fixed</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.fit_parameters_dictionaries.set_parameter_guess_and_limits.html">PyDDM.fit_parameters_dictionaries.set_parameter_guess_and_limits</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.fit_parameters_dictionaries.set_parameter_initial_guess.html">PyDDM.fit_parameters_dictionaries.set_parameter_initial_guess</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.fit_parameters_dictionaries.set_parameter_limits.html">PyDDM.fit_parameters_dictionaries.set_parameter_limits</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.fit_parameters_dictionaries.turn_parameters_into_dataframe_for_display.html">PyDDM.fit_parameters_dictionaries.turn_parameters_into_dataframe_for_display</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="_autosummary/PyDDM.utils.html">PyDDM.utils</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.create_two_time_correlation_matrix.html">PyDDM.utils.create_two_time_correlation_matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.generate_pandas_data.html">PyDDM.utils.generate_pandas_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.generate_pandas_table_fit_results.html">PyDDM.utils.generate_pandas_table_fit_results</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.get_schulz_dist.html">PyDDM.utils.get_schulz_dist</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.get_velocity_variance.html">PyDDM.utils.get_velocity_variance</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.newt.html">PyDDM.utils.newt</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.plot_amplitude.html">PyDDM.utils.plot_amplitude</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.plot_amplitude_over_background.html">PyDDM.utils.plot_amplitude_over_background</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.plot_background.html">PyDDM.utils.plot_background</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.plot_fraction.html">PyDDM.utils.plot_fraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.plot_nonerg.html">PyDDM.utils.plot_nonerg</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.plot_one_tau_vs_q.html">PyDDM.utils.plot_one_tau_vs_q</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.plot_schulz.html">PyDDM.utils.plot_schulz</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.plot_stretching_exponent.html">PyDDM.utils.plot_stretching_exponent</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.plot_to_inspect_fit.html">PyDDM.utils.plot_to_inspect_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.plot_to_inspect_fit_2x2subplot.html">PyDDM.utils.plot_to_inspect_fit_2x2subplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.smoothstep.html">PyDDM.utils.smoothstep</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/PyDDM.utils.view_colormap.html">PyDDM.utils.view_colormap</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Walkthrough - details.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>More detailed walkthrough</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Importing-the-necessary-modules">Importing the necessary modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Initializing-DDM_Analysis-class-and-computing-the-DDM-matrix">Initializing DDM_Analysis class and computing the DDM matrix</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Digging-into-the-DDM-xarray.Dataset">Digging into the DDM xarray.Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Different-data-selecting-methods">Different data selecting methods</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Determing-the-A-and-B-parameters-to-get-the-ISF">Determing the A and B parameters to get the ISF</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Checking-the-background-estimate">Checking the background estimate</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Additional-notes-about-the-background">Additional notes about the background</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Initiazing-DDM_Fit-class-and-fitting-our-data-to-a-model">Initiazing DDM_Fit class and fitting our data to a model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Our-first-attemp-at-fitting-the-data">Our first attemp at fitting the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Our-second-attemp-at-fitting-the-data---updating-initial-guesses-for-tau">Our second attemp at fitting the data - updating initial guesses for tau</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Our-third-attemp-at-fitting-the-data---tightening-the-bounds-on-the-stretching-exponent">Our third attemp at fitting the data - tightening the bounds on the stretching exponent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#What-to-make-of-the-results-at-high-q">What to make of the results at high <span class="math notranslate nohighlight">\(q\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Determining-the-mean-squared-displacement-from-the-ISF">Determining the mean squared displacement from the ISF</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="More-detailed-walkthrough">
<h1>More detailed walkthrough<a class="headerlink" href="#More-detailed-walkthrough" title="Link to this heading">#</a></h1>
<p>See the simple walkthrough for a quicker introduction to the PyDDM package. Here, we will go into a little more depth.</p>
<div class="alert alert-block alert-info"><p>Tip: Before working through this, go through the simple walkthrough.</p>
</div><section id="Importing-the-necessary-modules">
<h2>Importing the necessary modules<a class="headerlink" href="#Importing-the-necessary-modules" title="Link to this heading">#</a></h2>
<p>We will ned to import <a class="reference external" href="https://numpy.org/">numpy</a>, <a class="reference external" href="https://matplotlib.org/">matplotlib</a>, and <a class="reference external" href="https://xarray.pydata.org/en/stable/">xarray</a>. We will also import the <a class="reference external" href="https://rmcgorty.github.io/PyDDM/">PyDDM</a> package.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span> <span class="c1">#numerical python used for working with arrays, mathematical operations</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span> <span class="c1">#package for labeling and adding metadata to multi-dimensional arrays</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;../../PyDDM&quot;</span><span class="p">)</span> <span class="c1">#must point to the PyDDM folder</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ddm_analysis_and_fitting</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ddm</span>
</pre></div>
</div>
</div>
</section>
<section id="Initializing-DDM_Analysis-class-and-computing-the-DDM-matrix">
<h2>Initializing DDM_Analysis class and computing the DDM matrix<a class="headerlink" href="#Initializing-DDM_Analysis-class-and-computing-the-DDM-matrix" title="Link to this heading">#</a></h2>
<p>The instance of the <code class="docutils literal notranslate"><span class="pre">DDM_Analysis</span></code> class we create will need, when initialized, metadata about the images to analyze and the analysis and fitting parameters. This can be done by using a <a class="reference external" href="https://yaml.org/">yaml</a> file as shown in the following cell of code (there, the metadata is saved in the file “<em>example_data_silica_beads.yml</em>”. But one can also initialize <code class="docutils literal notranslate"><span class="pre">DDM_Analysis</span></code> with a dictionary containing the necessary metadata. One way to create such a dictionary and then using it to
initialize <code class="docutils literal notranslate"><span class="pre">DDM_Analysis</span></code> is shown below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>
<span class="n">ddm_analysis_parameters_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">DataDirectory: &#39;C:/Users/rmcgorty/Documents/GitHub/DDM-at-USD/ExampleData/&#39;</span>
<span class="s2">FileName: &#39;images_nobin_40x_128x128_8bit.tif&#39;</span>
<span class="s2">Metadata:</span>
<span class="s2">  pixel_size: 0.242 # size of pixel in um</span>
<span class="s2">  frame_rate: 41.7 #frames per second</span>
<span class="s2">Analysis_parameters:</span>
<span class="s2">  number_lag_times: 40</span>
<span class="s2">  last_lag_time: 600</span>
<span class="s2">  binning: no</span>
<span class="s2">Fitting_parameters:</span>
<span class="s2">  model: &#39;DDM Matrix - Single Exponential&#39;</span>
<span class="s2">  Tau: [1.0, 0.001, 10]</span>
<span class="s2">  StretchingExp: [1.0, 0.5, 1.1]</span>
<span class="s2">  Amplitude: [1e2, 1, 1e6]</span>
<span class="s2">  Background: [2.5e4, 0, 1e7]</span>
<span class="s2">  Good_q_range: [5, 20]</span>
<span class="s2">  Auto_update_good_q_range: True</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">parameters_as_dictionary</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">ddm_analysis_parameters_str</span><span class="p">)</span>
<span class="n">ddm_calc</span> <span class="o">=</span> <span class="n">ddm</span><span class="o">.</span><span class="n">DDM_Analysis</span><span class="p">(</span><span class="n">parameters_as_dictionary</span><span class="p">)</span>
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#The yaml file `example_data_silica_beads.yml` contains the metadata and parameters above</span>

<span class="n">ddm_calc</span> <span class="o">=</span> <span class="n">ddm</span><span class="o">.</span><span class="n">DDM_Analysis</span><span class="p">(</span><span class="s2">&quot;../../Examples/example_data_silica_beads.yml&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Provided metadata: {&#39;pixel_size&#39;: 0.242, &#39;frame_rate&#39;: 41.7}
Image shape: 3000-by-128-by-128
Number of frames to use for analysis: 3000
Maximum lag time (in frames): 600
Number of lag times to compute DDM matrix: 40
</pre></div></div>
</div>
<p>Below, with the method <code class="docutils literal notranslate"><span class="pre">calculate_DDM_matrix</span></code>, we compute the DDM matrix and some associated data. The data will be stored as an <a class="reference external" href="https://xarray.pydata.org/en/stable/generated/xarray.Dataset.html">xarray Dataset</a> as an attribute to <code class="docutils literal notranslate"><span class="pre">ddm_calc</span></code> called <code class="docutils literal notranslate"><span class="pre">ddm_dataset</span></code>.</p>
<p><strong>Note</strong>: There are a few optional arguments we can pass to <code class="docutils literal notranslate"><span class="pre">calculate_DDM_matrix</span></code>. There is an optional argument <code class="docutils literal notranslate"><span class="pre">quiet</span></code> (<em>True</em> or <em>False</em>, <em>False</em> by default). Then we have some optional keyword arguments (all of which could also be specified in the YAML file). These are: <code class="docutils literal notranslate"><span class="pre">overlap_method</span></code> which sets the degree of overlap between image pairs when finding all image differences for a each lag time and is either <em>0</em>, <em>1</em>, <em>2</em>, or <em>3</em>, <code class="docutils literal notranslate"><span class="pre">background_method</span></code> which sets how to estimate the
background parameter <em>B</em> and is either <em>0</em>, <em>1</em>, <em>2</em>, or <em>3</em>, and <code class="docutils literal notranslate"><span class="pre">number_lag_times</span></code>. If any of these three keyword arguments are set here, the value specified in the YAML file will be overwritten.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddm_calc</span><span class="o">.</span><span class="n">calculate_DDM_matrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2022-02-10 14:00:30,212 - DDM Calculations - Running dt = 1...
2022-02-10 14:00:37,571 - DDM Calculations - Running dt = 5...
2022-02-10 14:00:43,229 - DDM Calculations - Running dt = 9...
2022-02-10 14:00:47,878 - DDM Calculations - Running dt = 16...
2022-02-10 14:00:51,469 - DDM Calculations - Running dt = 27...
2022-02-10 14:00:54,913 - DDM Calculations - Running dt = 47...
2022-02-10 14:00:58,136 - DDM Calculations - Running dt = 81...
2022-02-10 14:01:01,219 - DDM Calculations - Running dt = 138...
2022-02-10 14:01:04,153 - DDM Calculations - Running dt = 236...
2022-02-10 14:01:07,126 - DDM Calculations - Running dt = 402...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DDM matrix took 39.838425159454346 seconds to compute.
 Background estimate ± std is 211.17 ± 1.49
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:           (lagtime: 40, q_y: 128, q_x: 128, q: 64, y: 128, x: 128, frames: 40)
Coordinates:
  * lagtime           (lagtime) float64 0.02398 0.04796 0.07194 ... 12.59 14.36
    framelag          (frames) int32 1 2 3 4 5 6 7 ... 308 352 402 459 525 599
  * q_y               (q_y) float64 -12.98 -12.78 -12.58 ... 12.37 12.58 12.78
  * q_x               (q_x) float64 -12.98 -12.78 -12.58 ... 12.37 12.58 12.78
  * q                 (q) float64 0.0 0.2028 0.4057 0.6085 ... 12.37 12.58 12.78
  * y                 (y) int32 0 1 2 3 4 5 6 7 ... 121 122 123 124 125 126 127
  * x                 (x) int32 0 1 2 3 4 5 6 7 ... 121 122 123 124 125 126 127
Dimensions without coordinates: frames
Data variables:
    ddm_matrix_full   (lagtime, q_y, q_x) float64 194.5 183.5 ... 192.0 196.8
    ddm_matrix        (lagtime, q) float64 0.0 294.2 321.4 ... 207.8 201.1 200.4
    first_image       (y, x) float64 128.0 149.0 173.0 ... 175.0 229.0 215.0
    avg_image_ft      (q) float64 0.0 1.293e+05 5.225e+03 ... 105.3 104.7 105.3
    num_pairs_per_dt  (lagtime) int32 2999 2998 2997 1498 1498 ... 20 17 15 13
    B                 float64 211.2
    B_std             float64 1.491
    Amplitude         (q) float64 -211.2 2.585e+05 1.024e+04 ... -1.699 -0.52
    ISF               (lagtime, q) float64 0.0 0.9997 0.9892 ... -4.952 -19.73
Attributes: (12/24)
    units:                   Intensity
    lagtime:                 sec
    q:                       μm$^{-1}$
    x:                       pixels
    y:                       pixels
    info:                    ddm_matrix is the averages of FFT difference ima...
    ...                      ...
    split_into_4_rois:       no
    use_windowing_function:  no
    binning:                 no
    bin_size:                2
    central_angle:           no
    angle_range:             no</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-55deaa26-59a5-41a2-8915-e53b1ba2663c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-55deaa26-59a5-41a2-8915-e53b1ba2663c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lagtime</span>: 40</li><li><span class='xr-has-index'>q_y</span>: 128</li><li><span class='xr-has-index'>q_x</span>: 128</li><li><span class='xr-has-index'>q</span>: 64</li><li><span class='xr-has-index'>y</span>: 128</li><li><span class='xr-has-index'>x</span>: 128</li><li><span>frames</span>: 40</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-5f052fc3-ebaa-4a95-8195-5503f392c566' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5f052fc3-ebaa-4a95-8195-5503f392c566' class='xr-section-summary' >Coordinates: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lagtime</span></div><div class='xr-var-dims'>(lagtime)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02398 0.04796 ... 12.59 14.36</div><input id='attrs-543c4aa0-4d15-4668-98e6-8447b998089f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-543c4aa0-4d15-4668-98e6-8447b998089f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ef9f26be-c027-425f-9e82-a48847cc9652' class='xr-var-data-in' type='checkbox'><label for='data-ef9f26be-c027-425f-9e82-a48847cc9652' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0.023981,  0.047962,  0.071942,  0.095923,  0.119904,  0.143885,
        0.167866,  0.191847,  0.215827,  0.263789,  0.28777 ,  0.335731,
        0.383693,  0.431655,  0.503597,  0.57554 ,  0.647482,  0.743405,
        0.863309,  0.983213,  1.127098,  1.294964,  1.486811,  1.702638,
        1.942446,  2.206235,  2.541966,  2.901679,  3.309353,  3.788969,
        4.316547,  4.940048,  5.659472,  6.450839,  7.386091,  8.441247,
        9.640288, 11.007194, 12.589928, 14.364508])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>framelag</span></div><div class='xr-var-dims'>(frames)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 ... 352 402 459 525 599</div><input id='attrs-31772d5e-2e30-43ef-8762-ea5c5b90ce35' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-31772d5e-2e30-43ef-8762-ea5c5b90ce35' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b05e1cdb-d82c-4cf3-821a-f83626fa0333' class='xr-var-data-in' type='checkbox'><label for='data-b05e1cdb-d82c-4cf3-821a-f83626fa0333' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1,   2,   3,   4,   5,   6,   7,   8,   9,  11,  12,  14,  16,
        18,  21,  24,  27,  31,  36,  41,  47,  54,  62,  71,  81,  92,
       106, 121, 138, 158, 180, 206, 236, 269, 308, 352, 402, 459, 525,
       599])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>q_y</span></div><div class='xr-var-dims'>(q_y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-12.98 -12.78 ... 12.58 12.78</div><input id='attrs-78b1b5bb-e617-407d-a907-ee6cb87233b4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-78b1b5bb-e617-407d-a907-ee6cb87233b4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5cf347ae-8a9c-4549-8d57-bf147283b6c1' class='xr-var-data-in' type='checkbox'><label for='data-5cf347ae-8a9c-4549-8d57-bf147283b6c1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-12.981788, -12.778947, -12.576107, -12.373267, -12.170426, -11.967586,
       -11.764745, -11.561905, -11.359064, -11.156224, -10.953383, -10.750543,
       -10.547703, -10.344862, -10.142022,  -9.939181,  -9.736341,  -9.5335  ,
        -9.33066 ,  -9.12782 ,  -8.924979,  -8.722139,  -8.519298,  -8.316458,
        -8.113617,  -7.910777,  -7.707937,  -7.505096,  -7.302256,  -7.099415,
        -6.896575,  -6.693734,  -6.490894,  -6.288053,  -6.085213,  -5.882373,
        -5.679532,  -5.476692,  -5.273851,  -5.071011,  -4.86817 ,  -4.66533 ,
        -4.46249 ,  -4.259649,  -4.056809,  -3.853968,  -3.651128,  -3.448287,
        -3.245447,  -3.042607,  -2.839766,  -2.636926,  -2.434085,  -2.231245,
        -2.028404,  -1.825564,  -1.622723,  -1.419883,  -1.217043,  -1.014202,
        -0.811362,  -0.608521,  -0.405681,  -0.20284 ,   0.      ,   0.20284 ,
         0.405681,   0.608521,   0.811362,   1.014202,   1.217043,   1.419883,
         1.622723,   1.825564,   2.028404,   2.231245,   2.434085,   2.636926,
         2.839766,   3.042607,   3.245447,   3.448287,   3.651128,   3.853968,
         4.056809,   4.259649,   4.46249 ,   4.66533 ,   4.86817 ,   5.071011,
         5.273851,   5.476692,   5.679532,   5.882373,   6.085213,   6.288053,
         6.490894,   6.693734,   6.896575,   7.099415,   7.302256,   7.505096,
         7.707937,   7.910777,   8.113617,   8.316458,   8.519298,   8.722139,
         8.924979,   9.12782 ,   9.33066 ,   9.5335  ,   9.736341,   9.939181,
        10.142022,  10.344862,  10.547703,  10.750543,  10.953383,  11.156224,
        11.359064,  11.561905,  11.764745,  11.967586,  12.170426,  12.373267,
        12.576107,  12.778947])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>q_x</span></div><div class='xr-var-dims'>(q_x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-12.98 -12.78 ... 12.58 12.78</div><input id='attrs-407d74a5-7952-46a4-87fa-fe1c3b9efbe5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-407d74a5-7952-46a4-87fa-fe1c3b9efbe5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a81904e6-bee0-47d8-8100-9e9ea7853d63' class='xr-var-data-in' type='checkbox'><label for='data-a81904e6-bee0-47d8-8100-9e9ea7853d63' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-12.981788, -12.778947, -12.576107, -12.373267, -12.170426, -11.967586,
       -11.764745, -11.561905, -11.359064, -11.156224, -10.953383, -10.750543,
       -10.547703, -10.344862, -10.142022,  -9.939181,  -9.736341,  -9.5335  ,
        -9.33066 ,  -9.12782 ,  -8.924979,  -8.722139,  -8.519298,  -8.316458,
        -8.113617,  -7.910777,  -7.707937,  -7.505096,  -7.302256,  -7.099415,
        -6.896575,  -6.693734,  -6.490894,  -6.288053,  -6.085213,  -5.882373,
        -5.679532,  -5.476692,  -5.273851,  -5.071011,  -4.86817 ,  -4.66533 ,
        -4.46249 ,  -4.259649,  -4.056809,  -3.853968,  -3.651128,  -3.448287,
        -3.245447,  -3.042607,  -2.839766,  -2.636926,  -2.434085,  -2.231245,
        -2.028404,  -1.825564,  -1.622723,  -1.419883,  -1.217043,  -1.014202,
        -0.811362,  -0.608521,  -0.405681,  -0.20284 ,   0.      ,   0.20284 ,
         0.405681,   0.608521,   0.811362,   1.014202,   1.217043,   1.419883,
         1.622723,   1.825564,   2.028404,   2.231245,   2.434085,   2.636926,
         2.839766,   3.042607,   3.245447,   3.448287,   3.651128,   3.853968,
         4.056809,   4.259649,   4.46249 ,   4.66533 ,   4.86817 ,   5.071011,
         5.273851,   5.476692,   5.679532,   5.882373,   6.085213,   6.288053,
         6.490894,   6.693734,   6.896575,   7.099415,   7.302256,   7.505096,
         7.707937,   7.910777,   8.113617,   8.316458,   8.519298,   8.722139,
         8.924979,   9.12782 ,   9.33066 ,   9.5335  ,   9.736341,   9.939181,
        10.142022,  10.344862,  10.547703,  10.750543,  10.953383,  11.156224,
        11.359064,  11.561905,  11.764745,  11.967586,  12.170426,  12.373267,
        12.576107,  12.778947])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>q</span></div><div class='xr-var-dims'>(q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.2028 0.4057 ... 12.58 12.78</div><input id='attrs-40c35b1a-ab99-487e-a494-97e870e07f58' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-40c35b1a-ab99-487e-a494-97e870e07f58' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-78bbb302-8854-4609-af4a-8af5e6e9b38f' class='xr-var-data-in' type='checkbox'><label for='data-78bbb302-8854-4609-af4a-8af5e6e9b38f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0.      ,  0.20284 ,  0.405681,  0.608521,  0.811362,  1.014202,
        1.217043,  1.419883,  1.622723,  1.825564,  2.028404,  2.231245,
        2.434085,  2.636926,  2.839766,  3.042607,  3.245447,  3.448287,
        3.651128,  3.853968,  4.056809,  4.259649,  4.46249 ,  4.66533 ,
        4.86817 ,  5.071011,  5.273851,  5.476692,  5.679532,  5.882373,
        6.085213,  6.288053,  6.490894,  6.693734,  6.896575,  7.099415,
        7.302256,  7.505096,  7.707937,  7.910777,  8.113617,  8.316458,
        8.519298,  8.722139,  8.924979,  9.12782 ,  9.33066 ,  9.5335  ,
        9.736341,  9.939181, 10.142022, 10.344862, 10.547703, 10.750543,
       10.953383, 11.156224, 11.359064, 11.561905, 11.764745, 11.967586,
       12.170426, 12.373267, 12.576107, 12.778947])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 ... 123 124 125 126 127</div><input id='attrs-bffc8ec9-0dc6-433d-b561-d2a1d4de212a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bffc8ec9-0dc6-433d-b561-d2a1d4de212a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eed5258d-0965-4b36-94ad-1c8ae00a5101' class='xr-var-data-in' type='checkbox'><label for='data-eed5258d-0965-4b36-94ad-1c8ae00a5101' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
        14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,  41,
        42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,  54,  55,
        56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,  67,  68,  69,
        70,  71,  72,  73,  74,  75,  76,  77,  78,  79,  80,  81,  82,  83,
        84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96,  97,
        98,  99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111,
       112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125,
       126, 127])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 ... 123 124 125 126 127</div><input id='attrs-6f08c84e-b0c5-4c44-93f4-71e41a72c46f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6f08c84e-b0c5-4c44-93f4-71e41a72c46f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-04736fab-7d4d-443d-821d-49655cc3b205' class='xr-var-data-in' type='checkbox'><label for='data-04736fab-7d4d-443d-821d-49655cc3b205' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
        14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,  41,
        42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,  54,  55,
        56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,  67,  68,  69,
        70,  71,  72,  73,  74,  75,  76,  77,  78,  79,  80,  81,  82,  83,
        84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96,  97,
        98,  99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111,
       112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125,
       126, 127])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-161876cb-8790-4a63-aeaf-1102f38fc8c2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-161876cb-8790-4a63-aeaf-1102f38fc8c2' class='xr-section-summary' >Data variables: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ddm_matrix_full</span></div><div class='xr-var-dims'>(lagtime, q_y, q_x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>194.5 183.5 189.9 ... 192.0 196.8</div><input id='attrs-459c7e7d-ea3b-4eb6-9ea3-d0d867127f6e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-459c7e7d-ea3b-4eb6-9ea3-d0d867127f6e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4315a467-e6a7-42c0-a391-5c0444356001' class='xr-var-data-in' type='checkbox'><label for='data-4315a467-e6a7-42c0-a391-5c0444356001' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[194.53933642, 183.46865602, 189.88360447, ..., 185.13501835,
         189.88360447, 183.46865602],
        [180.54977527, 184.19554752, 188.62431121, ..., 190.98754022,
         197.43847912, 186.62178023],
        [192.70890797, 195.93098872, 189.09845247, ..., 190.12737145,
         189.83523821, 192.21421257],
        ...,
        [178.74506797, 186.95925279, 189.9972449 , ..., 190.31796269,
         193.86216905, 184.71498966],
        [192.70890797, 192.21421257, 189.83523821, ..., 194.82373533,
         189.09845247, 195.93098872],
        [180.54977527, 186.62178023, 197.43847912, ..., 189.320714  ,
         188.62431121, 184.19554752]],

       [[192.53678443, 184.98536047, 183.00178339, ..., 189.93758386,
         183.00178339, 184.98536047],
        [182.22340665, 190.38208686, 185.90468391, ..., 188.79454507,
         188.52514631, 188.48204681],
        [192.71415943, 196.71513926, 189.84504279, ..., 187.27424593,
         187.74393152, 186.99244495],
...
        [224.60947387, 108.81451286, 189.02957545, ..., 137.44506309,
         348.30437843, 228.73579002],
        [216.96920343, 166.46373793, 174.79469182, ..., 166.69258334,
         126.31953212, 140.52349943],
        [164.20961535, 169.57957548, 133.76022938, ..., 125.77861768,
         159.69240297, 247.86589588]],

       [[ 75.33297495, 174.05006796, 155.35027909, ..., 233.98667431,
         155.35027909, 174.05006796],
        [167.22701098, 196.84765156, 192.02546007, ..., 131.6447673 ,
         119.41026107, 235.53961919],
        [132.75085561, 149.1865022 , 144.63052109, ..., 237.29431965,
         217.6141243 , 128.83335999],
        ...,
        [244.06105601, 195.72999615, 198.70767797, ..., 346.86825864,
         208.46454057, 182.9136883 ],
        [132.75085561, 128.83335999, 217.6141243 , ..., 137.87697986,
         144.63052109, 149.1865022 ],
        [167.22701098, 235.53961919, 119.41026107, ..., 165.83630492,
         192.02546007, 196.84765156]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ddm_matrix</span></div><div class='xr-var-dims'>(lagtime, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 294.2 321.4 ... 201.1 200.4</div><input id='attrs-2226cdb8-6ece-4c7a-85ef-88f9c38bc332' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2226cdb8-6ece-4c7a-85ef-88f9c38bc332' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8565024a-bb21-4173-bf99-fbba7b65a511' class='xr-var-data-in' type='checkbox'><label for='data-8565024a-bb21-4173-bf99-fbba7b65a511' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[   0.        ,  294.18943955,  321.41822078, ...,  192.93331805,
         193.46556826,  192.76671589],
       [   0.        ,  432.05714374,  490.9677582 , ...,  194.84772175,
         195.06799833,  194.40459328],
       [   0.        ,  535.36374381,  619.95883018, ...,  196.12616285,
         196.21094092,  195.79399928],
       ...,
       [   0.        , 3966.56056507, 5791.89215548, ...,  205.00017796,
         211.36062787,  212.61362392],
       [   0.        , 4167.1712352 , 5456.14848464, ...,  203.8398704 ,
         205.38454854,  207.78696548],
       [   0.        , 3716.77402137, 6067.88205869, ...,  207.76466695,
         201.06258553,  200.39635905]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>first_image</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>128.0 149.0 173.0 ... 229.0 215.0</div><input id='attrs-f52e1326-f47b-4fec-81ab-33b5f99d07a0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f52e1326-f47b-4fec-81ab-33b5f99d07a0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-650c729f-738c-4cf2-b462-9d78a96056e5' class='xr-var-data-in' type='checkbox'><label for='data-650c729f-738c-4cf2-b462-9d78a96056e5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[128., 149., 173., ..., 178., 224., 255.],
       [164., 163., 166., ..., 182., 197., 255.],
       [208., 182., 175., ..., 178., 210., 255.],
       ...,
       [147., 162., 162., ..., 182., 196., 165.],
       [201., 214., 234., ..., 189., 174., 178.],
       [255., 255., 255., ..., 175., 229., 215.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>avg_image_ft</span></div><div class='xr-var-dims'>(q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.293e+05 ... 104.7 105.3</div><input id='attrs-83f15301-7424-462c-8a3e-e5d6fa60da67' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-83f15301-7424-462c-8a3e-e5d6fa60da67' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8f96fcdb-f848-4a07-b1a6-1a6548666455' class='xr-var-data-in' type='checkbox'><label for='data-8f96fcdb-f848-4a07-b1a6-1a6548666455' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.00000000e+00, 1.29341509e+05, 5.22511731e+03, 5.86989569e+03,
       8.50478146e+03, 9.68446541e+03, 9.99103750e+03, 1.03319622e+04,
       1.00264087e+04, 1.08058729e+04, 1.16343568e+04, 1.38669622e+04,
       1.68988722e+04, 1.98642184e+04, 2.11800678e+04, 2.14311022e+04,
       2.06130601e+04, 1.80258072e+04, 1.42561639e+04, 1.04082328e+04,
       7.27537584e+03, 4.68549415e+03, 2.88015028e+03, 1.77658315e+03,
       1.06139768e+03, 6.83505113e+02, 4.97908069e+02, 4.18238638e+02,
       3.38383278e+02, 2.72050227e+02, 2.35672326e+02, 2.24525405e+02,
       2.03430129e+02, 1.78436880e+02, 1.65009527e+02, 1.49291391e+02,
       1.41201296e+02, 1.33121051e+02, 1.29764821e+02, 1.28159612e+02,
       1.24131175e+02, 1.24052104e+02, 1.21220015e+02, 1.19076951e+02,
       1.17509287e+02, 1.15310101e+02, 1.15268069e+02, 1.12572652e+02,
       1.11849673e+02, 1.11765243e+02, 1.10247178e+02, 1.09703002e+02,
       1.08834403e+02, 1.09662333e+02, 1.08597899e+02, 1.07728419e+02,
       1.07789289e+02, 1.06907057e+02, 1.07036538e+02, 1.05981891e+02,
       1.05125261e+02, 1.05313067e+02, 1.04737380e+02, 1.05326832e+02])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>num_pairs_per_dt</span></div><div class='xr-var-dims'>(lagtime)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>2999 2998 2997 1498 ... 20 17 15 13</div><input id='attrs-b67cbf8a-b5c7-417c-9c53-142cd0822c61' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b67cbf8a-b5c7-417c-9c53-142cd0822c61' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-38ea42c5-df98-411f-b3fd-b6347b2fcd37' class='xr-var-data-in' type='checkbox'><label for='data-38ea42c5-df98-411f-b3fd-b6347b2fcd37' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2999, 2998, 2997, 1498, 1498, 1497,  998,  998,  997,  748,  747,
        598,  498,  497,  426,  372,  331,  270,  247,  212,  185,  164,
        140,  123,  109,   94,   81,   71,   63,   54,   47,   41,   35,
         31,   27,   23,   20,   17,   15,   13])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>B</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>211.2</div><input id='attrs-7c05ad7b-c7c9-4085-ba8c-6ff9cf201b71' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7c05ad7b-c7c9-4085-ba8c-6ff9cf201b71' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8558d876-03f6-45cd-8cb3-ae449005ee6e' class='xr-var-data-in' type='checkbox'><label for='data-8558d876-03f6-45cd-8cb3-ae449005ee6e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(211.17365621)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>B_std</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.491</div><input id='attrs-4481d8d6-2324-4f00-985f-280e6d74ef09' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4481d8d6-2324-4f00-985f-280e6d74ef09' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-531eb25f-c2e2-45e7-a1bf-837052a1ee4c' class='xr-var-data-in' type='checkbox'><label for='data-531eb25f-c2e2-45e7-a1bf-837052a1ee4c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.49105881)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Amplitude</span></div><div class='xr-var-dims'>(q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-211.2 2.585e+05 ... -1.699 -0.52</div><input id='attrs-f6253846-0332-4a7d-89de-811726ef1a01' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f6253846-0332-4a7d-89de-811726ef1a01' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-510e330e-dba8-4f78-af4d-8e8379905749' class='xr-var-data-in' type='checkbox'><label for='data-510e330e-dba8-4f78-af4d-8e8379905749' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-2.11173656e+02,  2.58471844e+05,  1.02390610e+04,  1.15286177e+04,
        1.67983893e+04,  1.91577572e+04,  1.97709014e+04,  2.04527506e+04,
        1.98416438e+04,  2.14005721e+04,  2.30575400e+04,  2.75227507e+04,
        3.35865707e+04,  3.95172631e+04,  4.21489620e+04,  4.26510308e+04,
        4.10149466e+04,  3.58404407e+04,  2.83011541e+04,  2.06052919e+04,
        1.43395780e+04,  9.15981465e+03,  5.54912690e+03,  3.34199265e+03,
        1.91162170e+03,  1.15583657e+03,  7.84642482e+02,  6.25303620e+02,
        4.65592900e+02,  3.32926798e+02,  2.60170996e+02,  2.37877154e+02,
        1.95686602e+02,  1.45700103e+02,  1.18845397e+02,  8.74091262e+01,
        7.12289354e+01,  5.50684455e+01,  4.83559858e+01,  4.51455685e+01,
        3.70886933e+01,  3.69305527e+01,  3.12663737e+01,  2.69802467e+01,
        2.38449170e+01,  1.94465450e+01,  1.93624826e+01,  1.39716478e+01,
        1.25256899e+01,  1.23568306e+01,  9.32069947e+00,  8.23234748e+00,
        6.49514954e+00,  8.15100953e+00,  6.02214129e+00,  4.28318246e+00,
        4.40492236e+00,  2.64045708e+00,  2.89942014e+00,  7.90126460e-01,
       -9.23134186e-01, -5.47522559e-01, -1.69889697e+00, -5.19992889e-01])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ISF</span></div><div class='xr-var-dims'>(lagtime, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.9997 0.9892 ... -4.952 -19.73</div><input id='attrs-9f7a64d2-c7da-4590-95e8-2b9169c669a3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9f7a64d2-c7da-4590-95e8-2b9169c669a3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bdb67dcd-7a6e-48d8-bd69-674a6a8e4bff' class='xr-var-data-in' type='checkbox'><label for='data-bdb67dcd-7a6e-48d8-bd69-674a6a8e4bff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[  0.        ,   0.99967882,   0.98923294, ..., -32.31431348,
         -9.42328539, -34.39844623],
       [  0.        ,   0.99914543,   0.97267385, ..., -28.81782979,
         -8.48006746, -31.24863895],
       [  0.        ,   0.99874574,   0.96007591, ..., -26.48287376,
         -7.80731178, -28.57666779],
       ...,
       [  0.        ,   0.98547081,   0.45495798, ..., -10.27529479,
          1.11005474,   3.76920654],
       [  0.        ,   0.98469467,   0.48774845, ..., -12.39449068,
         -2.40756842,  -5.51295585],
       [  0.        ,   0.98643721,   0.42800337, ...,  -5.22620786,
         -4.95155025, -19.7258549 ]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1401b0bf-8a86-446f-856d-bf96c153f981' class='xr-section-summary-in' type='checkbox'  ><label for='section-1401b0bf-8a86-446f-856d-bf96c153f981' class='xr-section-summary' >Attributes: <span>(24)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>Intensity</dd><dt><span>lagtime :</span></dt><dd>sec</dd><dt><span>q :</span></dt><dd>μm$^{-1}$</dd><dt><span>x :</span></dt><dd>pixels</dd><dt><span>y :</span></dt><dd>pixels</dd><dt><span>info :</span></dt><dd>ddm_matrix is the averages of FFT difference images, ravs are the radial averages</dd><dt><span>BackgroundMethod :</span></dt><dd>0</dd><dt><span>OverlapMethod :</span></dt><dd>2</dd><dt><span>DataDirectory :</span></dt><dd>C:/Users/rmcgorty/Documents/GitHub/PyDDM/Examples/</dd><dt><span>FileName :</span></dt><dd>images_nobin_40x_128x128_8bit.tif</dd><dt><span>pixel_size :</span></dt><dd>0.242</dd><dt><span>frame_rate :</span></dt><dd>41.7</dd><dt><span>starting_frame_number :</span></dt><dd>no</dd><dt><span>ending_frame_number :</span></dt><dd>no</dd><dt><span>number_lagtimes :</span></dt><dd>40</dd><dt><span>first_lag_time :</span></dt><dd>yes</dd><dt><span>last_lag_time :</span></dt><dd>600</dd><dt><span>crop_to_roi :</span></dt><dd>no</dd><dt><span>split_into_4_rois :</span></dt><dd>no</dd><dt><span>use_windowing_function :</span></dt><dd>no</dd><dt><span>binning :</span></dt><dd>no</dd><dt><span>bin_size :</span></dt><dd>2</dd><dt><span>central_angle :</span></dt><dd>no</dd><dt><span>angle_range :</span></dt><dd>no</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_8_3.png" src="_images/Walkthrough_-_details_8_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_8_4.png" src="_images/Walkthrough_-_details_8_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_8_5.png" src="_images/Walkthrough_-_details_8_5.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_8_6.png" src="_images/Walkthrough_-_details_8_6.png" />
</div>
</div>
<section id="Digging-into-the-DDM-xarray.Dataset">
<h3>Digging into the DDM xarray.Dataset<a class="headerlink" href="#Digging-into-the-DDM-xarray.Dataset" title="Link to this heading">#</a></h3>
<p>Let’s look at the dataset created after running <code class="docutils literal notranslate"><span class="pre">calculate_DDM_matrix</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:           (lagtime: 40, q_y: 128, q_x: 128, q: 64, y: 128, x: 128, frames: 40)
Coordinates:
  * lagtime           (lagtime) float64 0.02398 0.04796 0.07194 ... 12.59 14.36
    framelag          (frames) int32 1 2 3 4 5 6 7 ... 308 352 402 459 525 599
  * q_y               (q_y) float64 -12.98 -12.78 -12.58 ... 12.37 12.58 12.78
  * q_x               (q_x) float64 -12.98 -12.78 -12.58 ... 12.37 12.58 12.78
  * q                 (q) float64 0.0 0.2028 0.4057 0.6085 ... 12.37 12.58 12.78
  * y                 (y) int32 0 1 2 3 4 5 6 7 ... 121 122 123 124 125 126 127
  * x                 (x) int32 0 1 2 3 4 5 6 7 ... 121 122 123 124 125 126 127
Dimensions without coordinates: frames
Data variables:
    ddm_matrix_full   (lagtime, q_y, q_x) float64 194.5 183.5 ... 192.0 196.8
    ddm_matrix        (lagtime, q) float64 0.0 294.2 321.4 ... 207.8 201.1 200.4
    first_image       (y, x) float64 128.0 149.0 173.0 ... 175.0 229.0 215.0
    avg_image_ft      (q) float64 0.0 1.293e+05 5.225e+03 ... 105.3 104.7 105.3
    num_pairs_per_dt  (lagtime) int32 2999 2998 2997 1498 1498 ... 20 17 15 13
    B                 float64 211.2
    B_std             float64 1.491
    Amplitude         (q) float64 -211.2 2.585e+05 1.024e+04 ... -1.699 -0.52
    ISF               (lagtime, q) float64 0.0 0.9997 0.9892 ... -4.952 -19.73
Attributes: (12/24)
    units:                   Intensity
    lagtime:                 sec
    q:                       μm$^{-1}$
    x:                       pixels
    y:                       pixels
    info:                    ddm_matrix is the averages of FFT difference ima...
    ...                      ...
    split_into_4_rois:       no
    use_windowing_function:  no
    binning:                 no
    bin_size:                2
    central_angle:           no
    angle_range:             no</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-975aa7ce-c30c-4ad5-884b-7f143af056c0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-975aa7ce-c30c-4ad5-884b-7f143af056c0' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lagtime</span>: 40</li><li><span class='xr-has-index'>q_y</span>: 128</li><li><span class='xr-has-index'>q_x</span>: 128</li><li><span class='xr-has-index'>q</span>: 64</li><li><span class='xr-has-index'>y</span>: 128</li><li><span class='xr-has-index'>x</span>: 128</li><li><span>frames</span>: 40</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-baf56383-6657-413c-a0a4-1b117fd1fd69' class='xr-section-summary-in' type='checkbox'  checked><label for='section-baf56383-6657-413c-a0a4-1b117fd1fd69' class='xr-section-summary' >Coordinates: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lagtime</span></div><div class='xr-var-dims'>(lagtime)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02398 0.04796 ... 12.59 14.36</div><input id='attrs-e4345a7a-7325-4ad8-b049-d3ab817ca8b9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e4345a7a-7325-4ad8-b049-d3ab817ca8b9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dfcc5f8e-ac83-4c24-aaf4-8757d57a9150' class='xr-var-data-in' type='checkbox'><label for='data-dfcc5f8e-ac83-4c24-aaf4-8757d57a9150' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0.023981,  0.047962,  0.071942,  0.095923,  0.119904,  0.143885,
        0.167866,  0.191847,  0.215827,  0.263789,  0.28777 ,  0.335731,
        0.383693,  0.431655,  0.503597,  0.57554 ,  0.647482,  0.743405,
        0.863309,  0.983213,  1.127098,  1.294964,  1.486811,  1.702638,
        1.942446,  2.206235,  2.541966,  2.901679,  3.309353,  3.788969,
        4.316547,  4.940048,  5.659472,  6.450839,  7.386091,  8.441247,
        9.640288, 11.007194, 12.589928, 14.364508])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>framelag</span></div><div class='xr-var-dims'>(frames)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 ... 352 402 459 525 599</div><input id='attrs-104e56ac-f63e-4be1-8947-cceaaf6cf1f0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-104e56ac-f63e-4be1-8947-cceaaf6cf1f0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-61f9ef8d-5ff8-4c53-9d88-96324599ff41' class='xr-var-data-in' type='checkbox'><label for='data-61f9ef8d-5ff8-4c53-9d88-96324599ff41' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1,   2,   3,   4,   5,   6,   7,   8,   9,  11,  12,  14,  16,
        18,  21,  24,  27,  31,  36,  41,  47,  54,  62,  71,  81,  92,
       106, 121, 138, 158, 180, 206, 236, 269, 308, 352, 402, 459, 525,
       599])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>q_y</span></div><div class='xr-var-dims'>(q_y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-12.98 -12.78 ... 12.58 12.78</div><input id='attrs-9b433553-fa24-4d8f-b951-1982f39b22e4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9b433553-fa24-4d8f-b951-1982f39b22e4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-611b0467-9190-4b4c-9edf-04ab341a42c1' class='xr-var-data-in' type='checkbox'><label for='data-611b0467-9190-4b4c-9edf-04ab341a42c1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-12.981788, -12.778947, -12.576107, -12.373267, -12.170426, -11.967586,
       -11.764745, -11.561905, -11.359064, -11.156224, -10.953383, -10.750543,
       -10.547703, -10.344862, -10.142022,  -9.939181,  -9.736341,  -9.5335  ,
        -9.33066 ,  -9.12782 ,  -8.924979,  -8.722139,  -8.519298,  -8.316458,
        -8.113617,  -7.910777,  -7.707937,  -7.505096,  -7.302256,  -7.099415,
        -6.896575,  -6.693734,  -6.490894,  -6.288053,  -6.085213,  -5.882373,
        -5.679532,  -5.476692,  -5.273851,  -5.071011,  -4.86817 ,  -4.66533 ,
        -4.46249 ,  -4.259649,  -4.056809,  -3.853968,  -3.651128,  -3.448287,
        -3.245447,  -3.042607,  -2.839766,  -2.636926,  -2.434085,  -2.231245,
        -2.028404,  -1.825564,  -1.622723,  -1.419883,  -1.217043,  -1.014202,
        -0.811362,  -0.608521,  -0.405681,  -0.20284 ,   0.      ,   0.20284 ,
         0.405681,   0.608521,   0.811362,   1.014202,   1.217043,   1.419883,
         1.622723,   1.825564,   2.028404,   2.231245,   2.434085,   2.636926,
         2.839766,   3.042607,   3.245447,   3.448287,   3.651128,   3.853968,
         4.056809,   4.259649,   4.46249 ,   4.66533 ,   4.86817 ,   5.071011,
         5.273851,   5.476692,   5.679532,   5.882373,   6.085213,   6.288053,
         6.490894,   6.693734,   6.896575,   7.099415,   7.302256,   7.505096,
         7.707937,   7.910777,   8.113617,   8.316458,   8.519298,   8.722139,
         8.924979,   9.12782 ,   9.33066 ,   9.5335  ,   9.736341,   9.939181,
        10.142022,  10.344862,  10.547703,  10.750543,  10.953383,  11.156224,
        11.359064,  11.561905,  11.764745,  11.967586,  12.170426,  12.373267,
        12.576107,  12.778947])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>q_x</span></div><div class='xr-var-dims'>(q_x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-12.98 -12.78 ... 12.58 12.78</div><input id='attrs-982b31a6-f666-4bfb-9dc3-4471eb4d4c43' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-982b31a6-f666-4bfb-9dc3-4471eb4d4c43' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-074e81db-2cf2-40d6-bcc7-849bf2ee83e8' class='xr-var-data-in' type='checkbox'><label for='data-074e81db-2cf2-40d6-bcc7-849bf2ee83e8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-12.981788, -12.778947, -12.576107, -12.373267, -12.170426, -11.967586,
       -11.764745, -11.561905, -11.359064, -11.156224, -10.953383, -10.750543,
       -10.547703, -10.344862, -10.142022,  -9.939181,  -9.736341,  -9.5335  ,
        -9.33066 ,  -9.12782 ,  -8.924979,  -8.722139,  -8.519298,  -8.316458,
        -8.113617,  -7.910777,  -7.707937,  -7.505096,  -7.302256,  -7.099415,
        -6.896575,  -6.693734,  -6.490894,  -6.288053,  -6.085213,  -5.882373,
        -5.679532,  -5.476692,  -5.273851,  -5.071011,  -4.86817 ,  -4.66533 ,
        -4.46249 ,  -4.259649,  -4.056809,  -3.853968,  -3.651128,  -3.448287,
        -3.245447,  -3.042607,  -2.839766,  -2.636926,  -2.434085,  -2.231245,
        -2.028404,  -1.825564,  -1.622723,  -1.419883,  -1.217043,  -1.014202,
        -0.811362,  -0.608521,  -0.405681,  -0.20284 ,   0.      ,   0.20284 ,
         0.405681,   0.608521,   0.811362,   1.014202,   1.217043,   1.419883,
         1.622723,   1.825564,   2.028404,   2.231245,   2.434085,   2.636926,
         2.839766,   3.042607,   3.245447,   3.448287,   3.651128,   3.853968,
         4.056809,   4.259649,   4.46249 ,   4.66533 ,   4.86817 ,   5.071011,
         5.273851,   5.476692,   5.679532,   5.882373,   6.085213,   6.288053,
         6.490894,   6.693734,   6.896575,   7.099415,   7.302256,   7.505096,
         7.707937,   7.910777,   8.113617,   8.316458,   8.519298,   8.722139,
         8.924979,   9.12782 ,   9.33066 ,   9.5335  ,   9.736341,   9.939181,
        10.142022,  10.344862,  10.547703,  10.750543,  10.953383,  11.156224,
        11.359064,  11.561905,  11.764745,  11.967586,  12.170426,  12.373267,
        12.576107,  12.778947])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>q</span></div><div class='xr-var-dims'>(q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.2028 0.4057 ... 12.58 12.78</div><input id='attrs-1caa042b-1f37-4746-a9c7-b81d6cbd49b2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1caa042b-1f37-4746-a9c7-b81d6cbd49b2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3b8ffc71-9403-4bf5-ae03-1d0b40629101' class='xr-var-data-in' type='checkbox'><label for='data-3b8ffc71-9403-4bf5-ae03-1d0b40629101' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0.      ,  0.20284 ,  0.405681,  0.608521,  0.811362,  1.014202,
        1.217043,  1.419883,  1.622723,  1.825564,  2.028404,  2.231245,
        2.434085,  2.636926,  2.839766,  3.042607,  3.245447,  3.448287,
        3.651128,  3.853968,  4.056809,  4.259649,  4.46249 ,  4.66533 ,
        4.86817 ,  5.071011,  5.273851,  5.476692,  5.679532,  5.882373,
        6.085213,  6.288053,  6.490894,  6.693734,  6.896575,  7.099415,
        7.302256,  7.505096,  7.707937,  7.910777,  8.113617,  8.316458,
        8.519298,  8.722139,  8.924979,  9.12782 ,  9.33066 ,  9.5335  ,
        9.736341,  9.939181, 10.142022, 10.344862, 10.547703, 10.750543,
       10.953383, 11.156224, 11.359064, 11.561905, 11.764745, 11.967586,
       12.170426, 12.373267, 12.576107, 12.778947])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 ... 123 124 125 126 127</div><input id='attrs-43db0abd-41b2-400c-b08c-6e988c606e1e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-43db0abd-41b2-400c-b08c-6e988c606e1e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-44cdc43f-4d5f-4028-bda1-d536dbfcb5d5' class='xr-var-data-in' type='checkbox'><label for='data-44cdc43f-4d5f-4028-bda1-d536dbfcb5d5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
        14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,  41,
        42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,  54,  55,
        56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,  67,  68,  69,
        70,  71,  72,  73,  74,  75,  76,  77,  78,  79,  80,  81,  82,  83,
        84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96,  97,
        98,  99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111,
       112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125,
       126, 127])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 ... 123 124 125 126 127</div><input id='attrs-ef2d8a81-5344-41c7-9a9d-edb1dc150a21' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ef2d8a81-5344-41c7-9a9d-edb1dc150a21' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-355e5233-1dde-4c8d-9922-d78c40df8eb9' class='xr-var-data-in' type='checkbox'><label for='data-355e5233-1dde-4c8d-9922-d78c40df8eb9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
        14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,  41,
        42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,  54,  55,
        56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,  67,  68,  69,
        70,  71,  72,  73,  74,  75,  76,  77,  78,  79,  80,  81,  82,  83,
        84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96,  97,
        98,  99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111,
       112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125,
       126, 127])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9cef3772-aedf-4433-b7b6-71f5e7dc6f1e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9cef3772-aedf-4433-b7b6-71f5e7dc6f1e' class='xr-section-summary' >Data variables: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ddm_matrix_full</span></div><div class='xr-var-dims'>(lagtime, q_y, q_x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>194.5 183.5 189.9 ... 192.0 196.8</div><input id='attrs-3aef9af1-c060-4211-9534-c95e6af21608' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3aef9af1-c060-4211-9534-c95e6af21608' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cacffa10-c279-4be2-8162-094c06a53445' class='xr-var-data-in' type='checkbox'><label for='data-cacffa10-c279-4be2-8162-094c06a53445' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[194.53933642, 183.46865602, 189.88360447, ..., 185.13501835,
         189.88360447, 183.46865602],
        [180.54977527, 184.19554752, 188.62431121, ..., 190.98754022,
         197.43847912, 186.62178023],
        [192.70890797, 195.93098872, 189.09845247, ..., 190.12737145,
         189.83523821, 192.21421257],
        ...,
        [178.74506797, 186.95925279, 189.9972449 , ..., 190.31796269,
         193.86216905, 184.71498966],
        [192.70890797, 192.21421257, 189.83523821, ..., 194.82373533,
         189.09845247, 195.93098872],
        [180.54977527, 186.62178023, 197.43847912, ..., 189.320714  ,
         188.62431121, 184.19554752]],

       [[192.53678443, 184.98536047, 183.00178339, ..., 189.93758386,
         183.00178339, 184.98536047],
        [182.22340665, 190.38208686, 185.90468391, ..., 188.79454507,
         188.52514631, 188.48204681],
        [192.71415943, 196.71513926, 189.84504279, ..., 187.27424593,
         187.74393152, 186.99244495],
...
        [224.60947387, 108.81451286, 189.02957545, ..., 137.44506309,
         348.30437843, 228.73579002],
        [216.96920343, 166.46373793, 174.79469182, ..., 166.69258334,
         126.31953212, 140.52349943],
        [164.20961535, 169.57957548, 133.76022938, ..., 125.77861768,
         159.69240297, 247.86589588]],

       [[ 75.33297495, 174.05006796, 155.35027909, ..., 233.98667431,
         155.35027909, 174.05006796],
        [167.22701098, 196.84765156, 192.02546007, ..., 131.6447673 ,
         119.41026107, 235.53961919],
        [132.75085561, 149.1865022 , 144.63052109, ..., 237.29431965,
         217.6141243 , 128.83335999],
        ...,
        [244.06105601, 195.72999615, 198.70767797, ..., 346.86825864,
         208.46454057, 182.9136883 ],
        [132.75085561, 128.83335999, 217.6141243 , ..., 137.87697986,
         144.63052109, 149.1865022 ],
        [167.22701098, 235.53961919, 119.41026107, ..., 165.83630492,
         192.02546007, 196.84765156]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ddm_matrix</span></div><div class='xr-var-dims'>(lagtime, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 294.2 321.4 ... 201.1 200.4</div><input id='attrs-9bd45ac8-c934-4c1e-bfdd-d44c0daeeb79' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9bd45ac8-c934-4c1e-bfdd-d44c0daeeb79' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a1510d2a-676e-4a72-8b3b-8e8882dbacfa' class='xr-var-data-in' type='checkbox'><label for='data-a1510d2a-676e-4a72-8b3b-8e8882dbacfa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[   0.        ,  294.18943955,  321.41822078, ...,  192.93331805,
         193.46556826,  192.76671589],
       [   0.        ,  432.05714374,  490.9677582 , ...,  194.84772175,
         195.06799833,  194.40459328],
       [   0.        ,  535.36374381,  619.95883018, ...,  196.12616285,
         196.21094092,  195.79399928],
       ...,
       [   0.        , 3966.56056507, 5791.89215548, ...,  205.00017796,
         211.36062787,  212.61362392],
       [   0.        , 4167.1712352 , 5456.14848464, ...,  203.8398704 ,
         205.38454854,  207.78696548],
       [   0.        , 3716.77402137, 6067.88205869, ...,  207.76466695,
         201.06258553,  200.39635905]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>first_image</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>128.0 149.0 173.0 ... 229.0 215.0</div><input id='attrs-a73eeba0-7c07-473a-837e-d310b01f5683' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a73eeba0-7c07-473a-837e-d310b01f5683' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dfefc635-0e30-4989-ab01-cc05e831477f' class='xr-var-data-in' type='checkbox'><label for='data-dfefc635-0e30-4989-ab01-cc05e831477f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[128., 149., 173., ..., 178., 224., 255.],
       [164., 163., 166., ..., 182., 197., 255.],
       [208., 182., 175., ..., 178., 210., 255.],
       ...,
       [147., 162., 162., ..., 182., 196., 165.],
       [201., 214., 234., ..., 189., 174., 178.],
       [255., 255., 255., ..., 175., 229., 215.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>avg_image_ft</span></div><div class='xr-var-dims'>(q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.293e+05 ... 104.7 105.3</div><input id='attrs-81bb25c9-fa25-4655-b58f-6fcd66c47de6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-81bb25c9-fa25-4655-b58f-6fcd66c47de6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-77a6799e-3e70-4e9d-bbd0-c8c28b866b56' class='xr-var-data-in' type='checkbox'><label for='data-77a6799e-3e70-4e9d-bbd0-c8c28b866b56' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.00000000e+00, 1.29341509e+05, 5.22511731e+03, 5.86989569e+03,
       8.50478146e+03, 9.68446541e+03, 9.99103750e+03, 1.03319622e+04,
       1.00264087e+04, 1.08058729e+04, 1.16343568e+04, 1.38669622e+04,
       1.68988722e+04, 1.98642184e+04, 2.11800678e+04, 2.14311022e+04,
       2.06130601e+04, 1.80258072e+04, 1.42561639e+04, 1.04082328e+04,
       7.27537584e+03, 4.68549415e+03, 2.88015028e+03, 1.77658315e+03,
       1.06139768e+03, 6.83505113e+02, 4.97908069e+02, 4.18238638e+02,
       3.38383278e+02, 2.72050227e+02, 2.35672326e+02, 2.24525405e+02,
       2.03430129e+02, 1.78436880e+02, 1.65009527e+02, 1.49291391e+02,
       1.41201296e+02, 1.33121051e+02, 1.29764821e+02, 1.28159612e+02,
       1.24131175e+02, 1.24052104e+02, 1.21220015e+02, 1.19076951e+02,
       1.17509287e+02, 1.15310101e+02, 1.15268069e+02, 1.12572652e+02,
       1.11849673e+02, 1.11765243e+02, 1.10247178e+02, 1.09703002e+02,
       1.08834403e+02, 1.09662333e+02, 1.08597899e+02, 1.07728419e+02,
       1.07789289e+02, 1.06907057e+02, 1.07036538e+02, 1.05981891e+02,
       1.05125261e+02, 1.05313067e+02, 1.04737380e+02, 1.05326832e+02])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>num_pairs_per_dt</span></div><div class='xr-var-dims'>(lagtime)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>2999 2998 2997 1498 ... 20 17 15 13</div><input id='attrs-c8c91368-5d69-4c50-a9b3-ea17dd7c4766' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c8c91368-5d69-4c50-a9b3-ea17dd7c4766' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-42d71a66-998b-4ff3-83fa-e9fcfc0a6e38' class='xr-var-data-in' type='checkbox'><label for='data-42d71a66-998b-4ff3-83fa-e9fcfc0a6e38' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2999, 2998, 2997, 1498, 1498, 1497,  998,  998,  997,  748,  747,
        598,  498,  497,  426,  372,  331,  270,  247,  212,  185,  164,
        140,  123,  109,   94,   81,   71,   63,   54,   47,   41,   35,
         31,   27,   23,   20,   17,   15,   13])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>B</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>211.2</div><input id='attrs-e4faa2bc-0e72-40a1-a16f-b5ef968c97be' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e4faa2bc-0e72-40a1-a16f-b5ef968c97be' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c81dc904-550d-47c1-8826-3c5d6b67302e' class='xr-var-data-in' type='checkbox'><label for='data-c81dc904-550d-47c1-8826-3c5d6b67302e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(211.17365621)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>B_std</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.491</div><input id='attrs-0670f511-f18e-480e-947e-d3630ff13c4e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0670f511-f18e-480e-947e-d3630ff13c4e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d3ce4064-e886-4dc8-a906-6362efb8c45a' class='xr-var-data-in' type='checkbox'><label for='data-d3ce4064-e886-4dc8-a906-6362efb8c45a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.49105881)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Amplitude</span></div><div class='xr-var-dims'>(q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-211.2 2.585e+05 ... -1.699 -0.52</div><input id='attrs-50a6602e-4bca-4f82-84b0-2b468e4ac00e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-50a6602e-4bca-4f82-84b0-2b468e4ac00e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d9f3d27b-9122-4140-8fda-697101165593' class='xr-var-data-in' type='checkbox'><label for='data-d9f3d27b-9122-4140-8fda-697101165593' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-2.11173656e+02,  2.58471844e+05,  1.02390610e+04,  1.15286177e+04,
        1.67983893e+04,  1.91577572e+04,  1.97709014e+04,  2.04527506e+04,
        1.98416438e+04,  2.14005721e+04,  2.30575400e+04,  2.75227507e+04,
        3.35865707e+04,  3.95172631e+04,  4.21489620e+04,  4.26510308e+04,
        4.10149466e+04,  3.58404407e+04,  2.83011541e+04,  2.06052919e+04,
        1.43395780e+04,  9.15981465e+03,  5.54912690e+03,  3.34199265e+03,
        1.91162170e+03,  1.15583657e+03,  7.84642482e+02,  6.25303620e+02,
        4.65592900e+02,  3.32926798e+02,  2.60170996e+02,  2.37877154e+02,
        1.95686602e+02,  1.45700103e+02,  1.18845397e+02,  8.74091262e+01,
        7.12289354e+01,  5.50684455e+01,  4.83559858e+01,  4.51455685e+01,
        3.70886933e+01,  3.69305527e+01,  3.12663737e+01,  2.69802467e+01,
        2.38449170e+01,  1.94465450e+01,  1.93624826e+01,  1.39716478e+01,
        1.25256899e+01,  1.23568306e+01,  9.32069947e+00,  8.23234748e+00,
        6.49514954e+00,  8.15100953e+00,  6.02214129e+00,  4.28318246e+00,
        4.40492236e+00,  2.64045708e+00,  2.89942014e+00,  7.90126460e-01,
       -9.23134186e-01, -5.47522559e-01, -1.69889697e+00, -5.19992889e-01])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ISF</span></div><div class='xr-var-dims'>(lagtime, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.9997 0.9892 ... -4.952 -19.73</div><input id='attrs-8752656e-9825-44c7-9bff-9e22e3c0f539' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8752656e-9825-44c7-9bff-9e22e3c0f539' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cbe3d4cc-c4dd-48fb-af95-689c2abd02a6' class='xr-var-data-in' type='checkbox'><label for='data-cbe3d4cc-c4dd-48fb-af95-689c2abd02a6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[  0.        ,   0.99967882,   0.98923294, ..., -32.31431348,
         -9.42328539, -34.39844623],
       [  0.        ,   0.99914543,   0.97267385, ..., -28.81782979,
         -8.48006746, -31.24863895],
       [  0.        ,   0.99874574,   0.96007591, ..., -26.48287376,
         -7.80731178, -28.57666779],
       ...,
       [  0.        ,   0.98547081,   0.45495798, ..., -10.27529479,
          1.11005474,   3.76920654],
       [  0.        ,   0.98469467,   0.48774845, ..., -12.39449068,
         -2.40756842,  -5.51295585],
       [  0.        ,   0.98643721,   0.42800337, ...,  -5.22620786,
         -4.95155025, -19.7258549 ]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7f8377db-84f8-449f-9979-ea7ac84ae3d2' class='xr-section-summary-in' type='checkbox'  ><label for='section-7f8377db-84f8-449f-9979-ea7ac84ae3d2' class='xr-section-summary' >Attributes: <span>(24)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>Intensity</dd><dt><span>lagtime :</span></dt><dd>sec</dd><dt><span>q :</span></dt><dd>μm$^{-1}$</dd><dt><span>x :</span></dt><dd>pixels</dd><dt><span>y :</span></dt><dd>pixels</dd><dt><span>info :</span></dt><dd>ddm_matrix is the averages of FFT difference images, ravs are the radial averages</dd><dt><span>BackgroundMethod :</span></dt><dd>0</dd><dt><span>OverlapMethod :</span></dt><dd>2</dd><dt><span>DataDirectory :</span></dt><dd>C:/Users/rmcgorty/Documents/GitHub/PyDDM/Examples/</dd><dt><span>FileName :</span></dt><dd>images_nobin_40x_128x128_8bit.tif</dd><dt><span>pixel_size :</span></dt><dd>0.242</dd><dt><span>frame_rate :</span></dt><dd>41.7</dd><dt><span>starting_frame_number :</span></dt><dd>no</dd><dt><span>ending_frame_number :</span></dt><dd>no</dd><dt><span>number_lagtimes :</span></dt><dd>40</dd><dt><span>first_lag_time :</span></dt><dd>yes</dd><dt><span>last_lag_time :</span></dt><dd>600</dd><dt><span>crop_to_roi :</span></dt><dd>no</dd><dt><span>split_into_4_rois :</span></dt><dd>no</dd><dt><span>use_windowing_function :</span></dt><dd>no</dd><dt><span>binning :</span></dt><dd>no</dd><dt><span>bin_size :</span></dt><dd>2</dd><dt><span>central_angle :</span></dt><dd>no</dd><dt><span>angle_range :</span></dt><dd>no</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Notice the data variables: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">data_vars</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Notice the data variables:
 Data variables:
    ddm_matrix_full   (lagtime, q_y, q_x) float64 194.5 183.5 ... 192.0 196.8
    ddm_matrix        (lagtime, q) float64 0.0 294.2 321.4 ... 207.8 201.1 200.4
    first_image       (y, x) float64 128.0 149.0 173.0 ... 175.0 229.0 215.0
    avg_image_ft      (q) float64 0.0 1.293e+05 5.225e+03 ... 105.3 104.7 105.3
    num_pairs_per_dt  (lagtime) int32 2999 2998 2997 1498 1498 ... 20 17 15 13
    B                 float64 211.2
    B_std             float64 1.491
    Amplitude         (q) float64 -211.2 2.585e+05 1.024e+04 ... -1.699 -0.52
    ISF               (lagtime, q) float64 0.0 0.9997 0.9892 ... -4.952 -19.73
</pre></div></div>
</div>
<p>Within this <code class="docutils literal notranslate"><span class="pre">ddm_datset</span></code>, we have the DDM matrix <span class="math notranslate nohighlight">\(D(q_x, q_y, \Delta t)\)</span> stored as <code class="docutils literal notranslate"><span class="pre">ddm_matrix_full</span></code>. We can take a look at a slice of this matrix with the <code class="docutils literal notranslate"><span class="pre">matshow</span></code> function in <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################</span>
<span class="c1"># Displaying a slice of the full three-dimensional DDM matrix #</span>
<span class="c1">###############################################################</span>

<span class="n">lagtime_for_ddmmatrix</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">ddm_matrix_full</span><span class="p">[</span><span class="n">lagtime_for_ddmmatrix</span><span class="p">],</span> <span class="n">fignum</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="c1">#Setting up the ticks and tick labels so that they match q_x and q_y</span>
<span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">ddm_matrix_full</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">ticklabelsx</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">{:4.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">q_x</span><span class="p">[</span><span class="n">ticks</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">ticklabelsy</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">{:4.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">q_y</span><span class="p">[</span><span class="n">ticks</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ticklabelsx</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ticklabelsy</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;DDM matrix for lag time of </span><span class="si">%.3f</span><span class="s2"> s&quot;</span> <span class="o">%</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">lagtime</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;DDM matrix for lag time of 0.288 s&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_14_1.png" src="_images/Walkthrough_-_details_14_1.png" />
</div>
</div>
<p>The slice of the DDM matrix above looks pretty radially symmetric. This is expected as we are analyzing a video of silica particles diffusing randomly with no preferred direction. Because of this symmetry, we can radially average the DDM matrix to go from <span class="math notranslate nohighlight">\(D(q_x, q_y, \Delta t)\)</span> to <span class="math notranslate nohighlight">\(D(q, \Delta t)\)</span> where <span class="math notranslate nohighlight">\(q = \sqrt{q_x^2 + q_y^2}\)</span>.</p>
<p>Let’s plot a slice of this radially averaged DDM matrix <span class="math notranslate nohighlight">\(D(q, \Delta t)\)</span> (which is stored as the variable <code class="docutils literal notranslate"><span class="pre">ddm_matrix</span></code> in the <code class="docutils literal notranslate"><span class="pre">ddm_dataset</span></code>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######################################################################</span>
<span class="c1"># Plotting the radially averaged DDM matrix for a particular q-value #</span>
<span class="c1">######################################################################</span>

<span class="n">q_index</span> <span class="o">=</span> <span class="mi">15</span> <span class="c1">#index of the list of q values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">/</span><span class="mf">1.618</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">lagtime</span><span class="p">,</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">ddm_matrix</span><span class="p">[:,</span><span class="n">q_index</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Lag time (s)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;DDM matrix&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;DDM matrix for $q$ = </span><span class="si">%.3f</span><span class="s2"> $\mu$m$^{-1}$&quot;</span> <span class="o">%</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">q_index</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_16_0.png" src="_images/Walkthrough_-_details_16_0.png" />
</div>
</div>
<section id="Different-data-selecting-methods">
<h4>Different data selecting methods<a class="headerlink" href="#Different-data-selecting-methods" title="Link to this heading">#</a></h4>
<p>Since we are slicing this <a class="reference external" href="https://xarray.pydata.org/en/stable/generated/xarray.Dataset.html">xarray dataset</a>, let’s use the opportunity to go over different ways of selecting data stored in a dataset. See the <a class="reference external" href="https://xarray.pydata.org/en/stable/user-guide/indexing.html">xarray user guide</a> for more info.</p>
<ol class="arabic simple">
<li><p>We can use the <code class="docutils literal notranslate"><span class="pre">isel</span></code> function (see <a class="reference external" href="https://xarray.pydata.org/en/stable/generated/xarray.DataArray.isel.html">xarray.DataArray.isel</a>).</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">q_index</span> <span class="o">=</span> <span class="mi">15</span> <span class="c1">#index of the list of q values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">/</span><span class="mf">1.618</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">lagtime</span><span class="p">,</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">ddm_matrix</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">q_index</span><span class="p">),</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Lag time (s)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;DDM matrix&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;DDM matrix for q = </span><span class="si">%.3f</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">q_index</span><span class="p">])</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>We can select the desired <em>q</em> not based on its <strong>index</strong> but on its actual <strong>value</strong> with <code class="docutils literal notranslate"><span class="pre">sel</span></code> (see <a class="reference external" href="https://xarray.pydata.org/en/stable/generated/xarray.DataArray.sel.html">xarray.DataArray.sel</a>. Note that here we have to use <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">'nearest'</span></code> since we do not have a <em>q</em> value of exactly 3 <span class="math notranslate nohighlight">\(\mu\)</span>m<span class="math notranslate nohighlight">\(^{-1}\)</span>.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">q_index</span> <span class="o">=</span> <span class="mi">15</span> <span class="c1">#index of the list of q values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">/</span><span class="mf">1.618</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">lagtime</span><span class="p">,</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">ddm_matrix</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">),</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Lag time (s)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;DDM matrix&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;DDM matrix for q = </span><span class="si">%.3f</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">q_index</span><span class="p">])</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Lastly, we can create this plot (using whichever slicing method) with xarray’s plotting function (which just wraps <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code>). For more, see <a class="reference external" href="https://xarray.pydata.org/en/stable/generated/xarray.DataArray.plot.html">xarray.DataArray.plot</a>.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">q_index</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">ddm_matrix</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">q_index</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="Determing-the-A-and-B-parameters-to-get-the-ISF">
<h4>Determing the A and B parameters to get the ISF<a class="headerlink" href="#Determing-the-A-and-B-parameters-to-get-the-ISF" title="Link to this heading">#</a></h4>
<p>Let’s now look at the <code class="docutils literal notranslate"><span class="pre">avg_image_ft</span></code> data variable. This is a radially averaged average of all the Fourier transforms of the images (i.e., the radially average of <span class="math notranslate nohighlight">\(\left&lt; | \tilde{I}(q, t) |^2 \right&gt;_t\)</span>). This function should equal $ (1/2) <span class="math">\times `:nbsphinx-math:</span>left[ A(q) + B(q) right] <a href="#id1"><span class="problematic" id="id2">`</span></a>$.</p>
<p>If we make the assumption that at the highest wavevectors (large <span class="math notranslate nohighlight">\(q\)</span>) the amplitude, <span class="math notranslate nohighlight">\(A(q)\)</span>, goes to zero, then we can estimate the background, <span class="math notranslate nohighlight">\(B\)</span>. If we also assume that the background is a constant that’s independent of <span class="math notranslate nohighlight">\(q\)</span>, then we can determine <span class="math notranslate nohighlight">\(A(q)\)</span>.</p>
<p>Plotted below is this <code class="docutils literal notranslate"><span class="pre">avg_image_ft</span></code> along with a horizontal line which can be used to estimate <strong>half</strong> the background. This estimate is taken from the last 10% of the wavevectors. The background can be saved to the <code class="docutils literal notranslate"><span class="pre">B</span></code> data variable. And then we can determine the amplitude which is saved as the <code class="docutils literal notranslate"><span class="pre">Amplitude</span></code> variable.</p>
<div class="alert alert-block alert-info"><p>Note: What is described above is the default method for getting the background. Other methods can be selected with the optional parameter ‘background_method’ passed to the method ‘calculate_DDM_matrix’.</p>
</div><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">############################################################################################</span>
<span class="c1"># Plotting the average squared Fourier-transformed image as a function of the wavevector q #</span>
<span class="c1">############################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">/</span><span class="mf">1.618</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">avg_image_ft</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Wavevector, q ($\mu$m$^{-1}$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\left&lt; | \tilde</span><span class="si">{I}</span><span class="s2">(q, t) |^2 \right&gt;_t$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Default method to estimate the background and find the amplitude&quot;</span><span class="p">)</span>

<span class="n">number_of_hi_qs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">q</span><span class="p">))</span> <span class="c1">#for getting highest 10% of q&#39;s</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">avg_image_ft</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">number_of_hi_qs</span><span class="p">:]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.lines.Line2D at 0x2299c86dbb0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_21_1.png" src="_images/Walkthrough_-_details_21_1.png" />
</div>
</div>
<p>The other methods for getting the background (and from the background then estimating the amplitude) are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">background_method</span></code> = 1: <span class="math notranslate nohighlight">\(B\)</span> will be the minimum of the DDM matrix</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">background_method</span></code> = 2: <span class="math notranslate nohighlight">\(B\)</span> will be the average (over all lag times) of the DDM matrix at the largest wavevector <span class="math notranslate nohighlight">\(q\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">background_method</span></code> = 3: <span class="math notranslate nohighlight">\(B\)</span> = 0</p></li>
</ul>
<p>If we know <span class="math notranslate nohighlight">\(A(q)\)</span> and <span class="math notranslate nohighlight">\(B\)</span>, then we can find the intermediate scattering function, <span class="math notranslate nohighlight">\(f(q, \Delta t)\)</span>, by assuming that the DDM matrix is equal to <span class="math notranslate nohighlight">\(D (q, \Delta t) = A(q) \times \left[ 1 - f(q, \Delta t) \right] + B\)</span>.</p>
<p>The ISF is stored as the data variable <code class="docutils literal notranslate"><span class="pre">ISF</span></code> in the <code class="docutils literal notranslate"><span class="pre">ddm_dataset</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#############################################################################################################</span>
<span class="c1"># Plotting the intermediate scattering function (ISF) for a particular value of q as a function of lag time #</span>
<span class="c1">#############################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">/</span><span class="mf">1.618</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">lagtime</span><span class="p">,</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">ISF</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">),</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Lag time (s)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;ISF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;ISF for q = </span><span class="si">%.3f</span><span class="s2"> $\mu$m$^{-1}$&quot;</span> <span class="o">%</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_24_0.png" src="_images/Walkthrough_-_details_24_0.png" />
</div>
</div>
</section>
<section id="Checking-the-background-estimate">
<h4>Checking the background estimate<a class="headerlink" href="#Checking-the-background-estimate" title="Link to this heading">#</a></h4>
<p>We expect the ISF to go from 1 to 0. We may not see exactly this behavior in the ISF for all wavevectors. At larger wavevectors, the dynamics might be fast and we might not be taking images fast enough to see the early decay of the ISF. Conversely, at lower wavevectors, the dynamics might be slow and we may not be able to calculate the ISF for large enough lag times to see it decay all the way to zero. Additionally, for non-ergodic dynamics, the ISF may <strong>not</strong> decay to zero but to some value
sometimes referred to as the non-ergodicity parameter.</p>
<p>But another reason that the ISF may not go from 1 to 0 is that we did a poor job in estimating the background, <span class="math notranslate nohighlight">\(B\)</span>. Using the default method (<code class="docutils literal notranslate"><span class="pre">background_method</span> <span class="pre">=</span> <span class="pre">0</span></code>), we try to estimate <span class="math notranslate nohighlight">\(B\)</span> by looking at the average Fourier transforms of all the images, radially averaging that, and assuming that the amplitude goes to zero at large wavevectors. But another way to estimate <span class="math notranslate nohighlight">\(B\)</span> is to look at the DDM matrix at large wavevectors, as is plotted below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################################################################################</span>
<span class="c1"># Plotting the radially averaged DDM matrix for the greatest value of q as a function of lag time #</span>
<span class="c1">###################################################################################################</span>

<span class="n">q_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1">#index of the list of q values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">/</span><span class="mf">1.618</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">lagtime</span><span class="p">,</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">ddm_matrix</span><span class="p">[:,</span><span class="n">q_index</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Lag time (s)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;DDM matrix&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;DDM matrix for $q$ = </span><span class="si">%.3f</span><span class="s2"> $\mu$m$^{-1}$&quot;</span> <span class="o">%</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">q</span><span class="p">[</span><span class="n">q_index</span><span class="p">]);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="o">.</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.lines.Line2D at 0x229a6721f70&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_27_1.png" src="_images/Walkthrough_-_details_27_1.png" />
</div>
</div>
<p>The DDM matrix should go from the background, <span class="math notranslate nohighlight">\(B\)</span>, to the background plus amplitude, <span class="math notranslate nohighlight">\(B + A\)</span>, as a function of the lag time. From the above plot, it does look like we overestimated the background (perhaps the amplitude hadn’t gone quite to zero by the last wavevectors we measure?). From the plot, clearly the background is less than 195.</p>
<p>Let’s estimate the background at about 190. We can make this adjustment with the <code class="docutils literal notranslate"><span class="pre">recalculate_ISF_with_new_background</span></code> function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_ddm_matrix</span> <span class="o">=</span> <span class="n">ddm</span><span class="o">.</span><span class="n">recalculate_ISF_with_new_background</span><span class="p">(</span><span class="n">ddm_calc</span><span class="o">.</span><span class="n">ddm_dataset</span><span class="p">,</span> <span class="n">background_val</span><span class="o">=</span><span class="mi">190</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">new_ddm_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:           (lagtime: 40, q_y: 128, q_x: 128, q: 64, y: 128, x: 128, frames: 40)
Coordinates:
  * lagtime           (lagtime) float64 0.02398 0.04796 0.07194 ... 12.59 14.36
    framelag          (frames) int32 1 2 3 4 5 6 7 ... 308 352 402 459 525 599
  * q_y               (q_y) float64 -12.98 -12.78 -12.58 ... 12.37 12.58 12.78
  * q_x               (q_x) float64 -12.98 -12.78 -12.58 ... 12.37 12.58 12.78
  * q                 (q) float64 0.0 0.2028 0.4057 0.6085 ... 12.37 12.58 12.78
  * y                 (y) int32 0 1 2 3 4 5 6 7 ... 121 122 123 124 125 126 127
  * x                 (x) int32 0 1 2 3 4 5 6 7 ... 121 122 123 124 125 126 127
Dimensions without coordinates: frames
Data variables:
    ddm_matrix_full   (lagtime, q_y, q_x) float64 194.5 183.5 ... 192.0 196.8
    ddm_matrix        (lagtime, q) float64 0.0 294.2 321.4 ... 207.8 201.1 200.4
    first_image       (y, x) float64 128.0 149.0 173.0 ... 175.0 229.0 215.0
    avg_image_ft      (q) float64 0.0 1.293e+05 5.225e+03 ... 105.3 104.7 105.3
    num_pairs_per_dt  (lagtime) int32 2999 2998 2997 1498 1498 ... 20 17 15 13
    B                 int32 190
    B_std             float64 1.491
    Amplitude         (q) float64 -190.0 2.585e+05 1.026e+04 ... 19.47 20.65
    ISF               (lagtime, q) float64 0.0 0.9996 0.9872 ... 0.432 0.4966
Attributes: (12/24)
    units:                   Intensity
    lagtime:                 sec
    q:                       μm$^{-1}$
    x:                       pixels
    y:                       pixels
    info:                    ddm_matrix is the averages of FFT difference ima...
    ...                      ...
    split_into_4_rois:       no
    use_windowing_function:  no
    binning:                 no
    bin_size:                2
    central_angle:           no
    angle_range:             no</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-259e998e-19dc-44f4-833e-c228eb9ed16c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-259e998e-19dc-44f4-833e-c228eb9ed16c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lagtime</span>: 40</li><li><span class='xr-has-index'>q_y</span>: 128</li><li><span class='xr-has-index'>q_x</span>: 128</li><li><span class='xr-has-index'>q</span>: 64</li><li><span class='xr-has-index'>y</span>: 128</li><li><span class='xr-has-index'>x</span>: 128</li><li><span>frames</span>: 40</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-897c4196-3588-4bc9-9565-2fee4c57cb96' class='xr-section-summary-in' type='checkbox'  checked><label for='section-897c4196-3588-4bc9-9565-2fee4c57cb96' class='xr-section-summary' >Coordinates: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lagtime</span></div><div class='xr-var-dims'>(lagtime)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02398 0.04796 ... 12.59 14.36</div><input id='attrs-1d0b059a-b035-4e10-a2a8-20df242ad6fd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1d0b059a-b035-4e10-a2a8-20df242ad6fd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3e75dd98-8ee2-439d-ac49-a9b35b804d00' class='xr-var-data-in' type='checkbox'><label for='data-3e75dd98-8ee2-439d-ac49-a9b35b804d00' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0.023981,  0.047962,  0.071942,  0.095923,  0.119904,  0.143885,
        0.167866,  0.191847,  0.215827,  0.263789,  0.28777 ,  0.335731,
        0.383693,  0.431655,  0.503597,  0.57554 ,  0.647482,  0.743405,
        0.863309,  0.983213,  1.127098,  1.294964,  1.486811,  1.702638,
        1.942446,  2.206235,  2.541966,  2.901679,  3.309353,  3.788969,
        4.316547,  4.940048,  5.659472,  6.450839,  7.386091,  8.441247,
        9.640288, 11.007194, 12.589928, 14.364508])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>framelag</span></div><div class='xr-var-dims'>(frames)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 ... 352 402 459 525 599</div><input id='attrs-9a0055d2-c7ab-436f-9822-c6fb4913ce5f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9a0055d2-c7ab-436f-9822-c6fb4913ce5f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7e3ded91-66d4-4c89-b364-f88159d241ce' class='xr-var-data-in' type='checkbox'><label for='data-7e3ded91-66d4-4c89-b364-f88159d241ce' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1,   2,   3,   4,   5,   6,   7,   8,   9,  11,  12,  14,  16,
        18,  21,  24,  27,  31,  36,  41,  47,  54,  62,  71,  81,  92,
       106, 121, 138, 158, 180, 206, 236, 269, 308, 352, 402, 459, 525,
       599])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>q_y</span></div><div class='xr-var-dims'>(q_y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-12.98 -12.78 ... 12.58 12.78</div><input id='attrs-100b249a-f791-4279-a32a-344bc2f8d8c7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-100b249a-f791-4279-a32a-344bc2f8d8c7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-40bfc2fd-ad7b-42aa-981f-128db36f9dbe' class='xr-var-data-in' type='checkbox'><label for='data-40bfc2fd-ad7b-42aa-981f-128db36f9dbe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-12.981788, -12.778947, -12.576107, -12.373267, -12.170426, -11.967586,
       -11.764745, -11.561905, -11.359064, -11.156224, -10.953383, -10.750543,
       -10.547703, -10.344862, -10.142022,  -9.939181,  -9.736341,  -9.5335  ,
        -9.33066 ,  -9.12782 ,  -8.924979,  -8.722139,  -8.519298,  -8.316458,
        -8.113617,  -7.910777,  -7.707937,  -7.505096,  -7.302256,  -7.099415,
        -6.896575,  -6.693734,  -6.490894,  -6.288053,  -6.085213,  -5.882373,
        -5.679532,  -5.476692,  -5.273851,  -5.071011,  -4.86817 ,  -4.66533 ,
        -4.46249 ,  -4.259649,  -4.056809,  -3.853968,  -3.651128,  -3.448287,
        -3.245447,  -3.042607,  -2.839766,  -2.636926,  -2.434085,  -2.231245,
        -2.028404,  -1.825564,  -1.622723,  -1.419883,  -1.217043,  -1.014202,
        -0.811362,  -0.608521,  -0.405681,  -0.20284 ,   0.      ,   0.20284 ,
         0.405681,   0.608521,   0.811362,   1.014202,   1.217043,   1.419883,
         1.622723,   1.825564,   2.028404,   2.231245,   2.434085,   2.636926,
         2.839766,   3.042607,   3.245447,   3.448287,   3.651128,   3.853968,
         4.056809,   4.259649,   4.46249 ,   4.66533 ,   4.86817 ,   5.071011,
         5.273851,   5.476692,   5.679532,   5.882373,   6.085213,   6.288053,
         6.490894,   6.693734,   6.896575,   7.099415,   7.302256,   7.505096,
         7.707937,   7.910777,   8.113617,   8.316458,   8.519298,   8.722139,
         8.924979,   9.12782 ,   9.33066 ,   9.5335  ,   9.736341,   9.939181,
        10.142022,  10.344862,  10.547703,  10.750543,  10.953383,  11.156224,
        11.359064,  11.561905,  11.764745,  11.967586,  12.170426,  12.373267,
        12.576107,  12.778947])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>q_x</span></div><div class='xr-var-dims'>(q_x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-12.98 -12.78 ... 12.58 12.78</div><input id='attrs-366f6352-718a-47a2-97a8-5b3fc535dbec' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-366f6352-718a-47a2-97a8-5b3fc535dbec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b0a9f36b-2891-4f0d-90a8-6ab8633d5d82' class='xr-var-data-in' type='checkbox'><label for='data-b0a9f36b-2891-4f0d-90a8-6ab8633d5d82' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-12.981788, -12.778947, -12.576107, -12.373267, -12.170426, -11.967586,
       -11.764745, -11.561905, -11.359064, -11.156224, -10.953383, -10.750543,
       -10.547703, -10.344862, -10.142022,  -9.939181,  -9.736341,  -9.5335  ,
        -9.33066 ,  -9.12782 ,  -8.924979,  -8.722139,  -8.519298,  -8.316458,
        -8.113617,  -7.910777,  -7.707937,  -7.505096,  -7.302256,  -7.099415,
        -6.896575,  -6.693734,  -6.490894,  -6.288053,  -6.085213,  -5.882373,
        -5.679532,  -5.476692,  -5.273851,  -5.071011,  -4.86817 ,  -4.66533 ,
        -4.46249 ,  -4.259649,  -4.056809,  -3.853968,  -3.651128,  -3.448287,
        -3.245447,  -3.042607,  -2.839766,  -2.636926,  -2.434085,  -2.231245,
        -2.028404,  -1.825564,  -1.622723,  -1.419883,  -1.217043,  -1.014202,
        -0.811362,  -0.608521,  -0.405681,  -0.20284 ,   0.      ,   0.20284 ,
         0.405681,   0.608521,   0.811362,   1.014202,   1.217043,   1.419883,
         1.622723,   1.825564,   2.028404,   2.231245,   2.434085,   2.636926,
         2.839766,   3.042607,   3.245447,   3.448287,   3.651128,   3.853968,
         4.056809,   4.259649,   4.46249 ,   4.66533 ,   4.86817 ,   5.071011,
         5.273851,   5.476692,   5.679532,   5.882373,   6.085213,   6.288053,
         6.490894,   6.693734,   6.896575,   7.099415,   7.302256,   7.505096,
         7.707937,   7.910777,   8.113617,   8.316458,   8.519298,   8.722139,
         8.924979,   9.12782 ,   9.33066 ,   9.5335  ,   9.736341,   9.939181,
        10.142022,  10.344862,  10.547703,  10.750543,  10.953383,  11.156224,
        11.359064,  11.561905,  11.764745,  11.967586,  12.170426,  12.373267,
        12.576107,  12.778947])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>q</span></div><div class='xr-var-dims'>(q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.2028 0.4057 ... 12.58 12.78</div><input id='attrs-6547719a-cb8d-44e9-9582-002ecea41463' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6547719a-cb8d-44e9-9582-002ecea41463' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-32309a59-ae0f-4bf5-a26d-71e23b142830' class='xr-var-data-in' type='checkbox'><label for='data-32309a59-ae0f-4bf5-a26d-71e23b142830' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0.      ,  0.20284 ,  0.405681,  0.608521,  0.811362,  1.014202,
        1.217043,  1.419883,  1.622723,  1.825564,  2.028404,  2.231245,
        2.434085,  2.636926,  2.839766,  3.042607,  3.245447,  3.448287,
        3.651128,  3.853968,  4.056809,  4.259649,  4.46249 ,  4.66533 ,
        4.86817 ,  5.071011,  5.273851,  5.476692,  5.679532,  5.882373,
        6.085213,  6.288053,  6.490894,  6.693734,  6.896575,  7.099415,
        7.302256,  7.505096,  7.707937,  7.910777,  8.113617,  8.316458,
        8.519298,  8.722139,  8.924979,  9.12782 ,  9.33066 ,  9.5335  ,
        9.736341,  9.939181, 10.142022, 10.344862, 10.547703, 10.750543,
       10.953383, 11.156224, 11.359064, 11.561905, 11.764745, 11.967586,
       12.170426, 12.373267, 12.576107, 12.778947])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 ... 123 124 125 126 127</div><input id='attrs-3609255a-7613-4cd4-b852-d8cfa151df29' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3609255a-7613-4cd4-b852-d8cfa151df29' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ee0a4118-c739-4246-93e1-88e59e723e4b' class='xr-var-data-in' type='checkbox'><label for='data-ee0a4118-c739-4246-93e1-88e59e723e4b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
        14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,  41,
        42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,  54,  55,
        56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,  67,  68,  69,
        70,  71,  72,  73,  74,  75,  76,  77,  78,  79,  80,  81,  82,  83,
        84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96,  97,
        98,  99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111,
       112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125,
       126, 127])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 ... 123 124 125 126 127</div><input id='attrs-5d9508b9-dbba-4583-ba8e-988383b14ecb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5d9508b9-dbba-4583-ba8e-988383b14ecb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a5eff16a-b0b9-4538-8b8b-f95381b2a569' class='xr-var-data-in' type='checkbox'><label for='data-a5eff16a-b0b9-4538-8b8b-f95381b2a569' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
        14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,
        28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,  41,
        42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,  53,  54,  55,
        56,  57,  58,  59,  60,  61,  62,  63,  64,  65,  66,  67,  68,  69,
        70,  71,  72,  73,  74,  75,  76,  77,  78,  79,  80,  81,  82,  83,
        84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96,  97,
        98,  99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111,
       112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125,
       126, 127])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3363628a-17e7-4bfc-9fd6-1feda2edb6aa' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3363628a-17e7-4bfc-9fd6-1feda2edb6aa' class='xr-section-summary' >Data variables: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ddm_matrix_full</span></div><div class='xr-var-dims'>(lagtime, q_y, q_x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>194.5 183.5 189.9 ... 192.0 196.8</div><input id='attrs-de8dd0b8-d626-4283-8807-179dff8cb501' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-de8dd0b8-d626-4283-8807-179dff8cb501' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-34922bcc-b47a-4311-8add-c4348aefc5d1' class='xr-var-data-in' type='checkbox'><label for='data-34922bcc-b47a-4311-8add-c4348aefc5d1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[194.53933642, 183.46865602, 189.88360447, ..., 185.13501835,
         189.88360447, 183.46865602],
        [180.54977527, 184.19554752, 188.62431121, ..., 190.98754022,
         197.43847912, 186.62178023],
        [192.70890797, 195.93098872, 189.09845247, ..., 190.12737145,
         189.83523821, 192.21421257],
        ...,
        [178.74506797, 186.95925279, 189.9972449 , ..., 190.31796269,
         193.86216905, 184.71498966],
        [192.70890797, 192.21421257, 189.83523821, ..., 194.82373533,
         189.09845247, 195.93098872],
        [180.54977527, 186.62178023, 197.43847912, ..., 189.320714  ,
         188.62431121, 184.19554752]],

       [[192.53678443, 184.98536047, 183.00178339, ..., 189.93758386,
         183.00178339, 184.98536047],
        [182.22340665, 190.38208686, 185.90468391, ..., 188.79454507,
         188.52514631, 188.48204681],
        [192.71415943, 196.71513926, 189.84504279, ..., 187.27424593,
         187.74393152, 186.99244495],
...
        [224.60947387, 108.81451286, 189.02957545, ..., 137.44506309,
         348.30437843, 228.73579002],
        [216.96920343, 166.46373793, 174.79469182, ..., 166.69258334,
         126.31953212, 140.52349943],
        [164.20961535, 169.57957548, 133.76022938, ..., 125.77861768,
         159.69240297, 247.86589588]],

       [[ 75.33297495, 174.05006796, 155.35027909, ..., 233.98667431,
         155.35027909, 174.05006796],
        [167.22701098, 196.84765156, 192.02546007, ..., 131.6447673 ,
         119.41026107, 235.53961919],
        [132.75085561, 149.1865022 , 144.63052109, ..., 237.29431965,
         217.6141243 , 128.83335999],
        ...,
        [244.06105601, 195.72999615, 198.70767797, ..., 346.86825864,
         208.46454057, 182.9136883 ],
        [132.75085561, 128.83335999, 217.6141243 , ..., 137.87697986,
         144.63052109, 149.1865022 ],
        [167.22701098, 235.53961919, 119.41026107, ..., 165.83630492,
         192.02546007, 196.84765156]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ddm_matrix</span></div><div class='xr-var-dims'>(lagtime, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 294.2 321.4 ... 201.1 200.4</div><input id='attrs-c4856663-d3ad-4746-b3d8-3e15d754fa31' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c4856663-d3ad-4746-b3d8-3e15d754fa31' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bcdaa4a9-9ea4-4057-bce7-70df7b9293f4' class='xr-var-data-in' type='checkbox'><label for='data-bcdaa4a9-9ea4-4057-bce7-70df7b9293f4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[   0.        ,  294.18943955,  321.41822078, ...,  192.93331805,
         193.46556826,  192.76671589],
       [   0.        ,  432.05714374,  490.9677582 , ...,  194.84772175,
         195.06799833,  194.40459328],
       [   0.        ,  535.36374381,  619.95883018, ...,  196.12616285,
         196.21094092,  195.79399928],
       ...,
       [   0.        , 3966.56056507, 5791.89215548, ...,  205.00017796,
         211.36062787,  212.61362392],
       [   0.        , 4167.1712352 , 5456.14848464, ...,  203.8398704 ,
         205.38454854,  207.78696548],
       [   0.        , 3716.77402137, 6067.88205869, ...,  207.76466695,
         201.06258553,  200.39635905]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>first_image</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>128.0 149.0 173.0 ... 229.0 215.0</div><input id='attrs-84b9b10a-241f-4113-bce3-53396f76ca73' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-84b9b10a-241f-4113-bce3-53396f76ca73' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d59ad419-45f5-41bf-8b87-7def1d831b03' class='xr-var-data-in' type='checkbox'><label for='data-d59ad419-45f5-41bf-8b87-7def1d831b03' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[128., 149., 173., ..., 178., 224., 255.],
       [164., 163., 166., ..., 182., 197., 255.],
       [208., 182., 175., ..., 178., 210., 255.],
       ...,
       [147., 162., 162., ..., 182., 196., 165.],
       [201., 214., 234., ..., 189., 174., 178.],
       [255., 255., 255., ..., 175., 229., 215.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>avg_image_ft</span></div><div class='xr-var-dims'>(q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.293e+05 ... 104.7 105.3</div><input id='attrs-ef5b6a28-7a46-4f13-8cf9-97a3a6d9536e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ef5b6a28-7a46-4f13-8cf9-97a3a6d9536e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-66a798c8-4c96-4d09-8e01-5d5e7a419af0' class='xr-var-data-in' type='checkbox'><label for='data-66a798c8-4c96-4d09-8e01-5d5e7a419af0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.00000000e+00, 1.29341509e+05, 5.22511731e+03, 5.86989569e+03,
       8.50478146e+03, 9.68446541e+03, 9.99103750e+03, 1.03319622e+04,
       1.00264087e+04, 1.08058729e+04, 1.16343568e+04, 1.38669622e+04,
       1.68988722e+04, 1.98642184e+04, 2.11800678e+04, 2.14311022e+04,
       2.06130601e+04, 1.80258072e+04, 1.42561639e+04, 1.04082328e+04,
       7.27537584e+03, 4.68549415e+03, 2.88015028e+03, 1.77658315e+03,
       1.06139768e+03, 6.83505113e+02, 4.97908069e+02, 4.18238638e+02,
       3.38383278e+02, 2.72050227e+02, 2.35672326e+02, 2.24525405e+02,
       2.03430129e+02, 1.78436880e+02, 1.65009527e+02, 1.49291391e+02,
       1.41201296e+02, 1.33121051e+02, 1.29764821e+02, 1.28159612e+02,
       1.24131175e+02, 1.24052104e+02, 1.21220015e+02, 1.19076951e+02,
       1.17509287e+02, 1.15310101e+02, 1.15268069e+02, 1.12572652e+02,
       1.11849673e+02, 1.11765243e+02, 1.10247178e+02, 1.09703002e+02,
       1.08834403e+02, 1.09662333e+02, 1.08597899e+02, 1.07728419e+02,
       1.07789289e+02, 1.06907057e+02, 1.07036538e+02, 1.05981891e+02,
       1.05125261e+02, 1.05313067e+02, 1.04737380e+02, 1.05326832e+02])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>num_pairs_per_dt</span></div><div class='xr-var-dims'>(lagtime)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>2999 2998 2997 1498 ... 20 17 15 13</div><input id='attrs-bb2663dc-e6b1-4f95-99a0-64ea77eec3fa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bb2663dc-e6b1-4f95-99a0-64ea77eec3fa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-82b26cae-3855-40df-ae49-79bf7a03365c' class='xr-var-data-in' type='checkbox'><label for='data-82b26cae-3855-40df-ae49-79bf7a03365c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2999, 2998, 2997, 1498, 1498, 1497,  998,  998,  997,  748,  747,
        598,  498,  497,  426,  372,  331,  270,  247,  212,  185,  164,
        140,  123,  109,   94,   81,   71,   63,   54,   47,   41,   35,
         31,   27,   23,   20,   17,   15,   13])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>B</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>190</div><input id='attrs-a72abef0-b31d-47bb-8bde-cee79b2a72b8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a72abef0-b31d-47bb-8bde-cee79b2a72b8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e7ed9c12-0d08-4d66-a714-34c900d4b5d0' class='xr-var-data-in' type='checkbox'><label for='data-e7ed9c12-0d08-4d66-a714-34c900d4b5d0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(190)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>B_std</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.491</div><input id='attrs-955bacb7-cd50-4e61-9791-3f3ce5e7682b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-955bacb7-cd50-4e61-9791-3f3ce5e7682b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b5d2d1c4-45af-4c30-bb3e-63b0a2afedaf' class='xr-var-data-in' type='checkbox'><label for='data-b5d2d1c4-45af-4c30-bb3e-63b0a2afedaf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.49105881)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Amplitude</span></div><div class='xr-var-dims'>(q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-190.0 2.585e+05 ... 19.47 20.65</div><input id='attrs-7156408f-b545-42fc-a35b-863af5042312' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7156408f-b545-42fc-a35b-863af5042312' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b38d1492-2c1e-4631-9cb6-f47638fdfa85' class='xr-var-data-in' type='checkbox'><label for='data-b38d1492-2c1e-4631-9cb6-f47638fdfa85' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-1.90000000e+02,  2.58493018e+05,  1.02602346e+04,  1.15497914e+04,
        1.68195629e+04,  1.91789308e+04,  1.97920750e+04,  2.04739243e+04,
        1.98628174e+04,  2.14217457e+04,  2.30787136e+04,  2.75439244e+04,
        3.36077443e+04,  3.95384367e+04,  4.21701356e+04,  4.26722045e+04,
        4.10361202e+04,  3.58616144e+04,  2.83223278e+04,  2.06264656e+04,
        1.43607517e+04,  9.18098831e+03,  5.57030056e+03,  3.36316630e+03,
        1.93279536e+03,  1.17701023e+03,  8.05816138e+02,  6.46477276e+02,
        4.86766556e+02,  3.54100454e+02,  2.81344652e+02,  2.59050811e+02,
        2.16860258e+02,  1.66873759e+02,  1.40019053e+02,  1.08582782e+02,
        9.24025916e+01,  7.62421017e+01,  6.95296420e+01,  6.63192247e+01,
        5.82623495e+01,  5.81042089e+01,  5.24400299e+01,  4.81539029e+01,
        4.50185732e+01,  4.06202012e+01,  4.05361388e+01,  3.51453041e+01,
        3.36993461e+01,  3.35304868e+01,  3.04943557e+01,  2.94060037e+01,
        2.76688057e+01,  2.93246657e+01,  2.71957975e+01,  2.54568387e+01,
        2.55785786e+01,  2.38141133e+01,  2.40730764e+01,  2.19637827e+01,
        2.02505220e+01,  2.06261336e+01,  1.94747592e+01,  2.06536633e+01])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ISF</span></div><div class='xr-var-dims'>(lagtime, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.9996 0.9872 ... 0.432 0.4966</div><input id='attrs-5c39cc81-60b0-4f63-a61f-4159f2ebb8b0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5c39cc81-60b0-4f63-a61f-4159f2ebb8b0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6ecb59f9-dbb9-4baf-8bff-30529c627340' class='xr-var-data-in' type='checkbox'><label for='data-6ecb59f9-dbb9-4baf-8bff-30529c627340' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 0.        ,  0.99959694,  0.9871915 , ...,  0.85778634,
         0.82204821,  0.86604236],
       [ 0.        ,  0.99906358,  0.97066658, ...,  0.76497186,
         0.7397658 ,  0.78674034],
       [ 0.        ,  0.99866393,  0.95809464, ...,  0.70299025,
         0.6810774 ,  0.71946869],
       ...,
       [ 0.        ,  0.98539009,  0.4540191 , ...,  0.27275862,
        -0.09683656, -0.09489651],
       [ 0.        ,  0.98461401,  0.4867419 , ...,  0.32901286,
         0.21002625,  0.13879852],
       [ 0.        ,  0.98635641,  0.42712011, ...,  0.13873015,
         0.43195264,  0.49663365]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2b36d44d-3eb5-4b91-8ecb-355f27f9b378' class='xr-section-summary-in' type='checkbox'  ><label for='section-2b36d44d-3eb5-4b91-8ecb-355f27f9b378' class='xr-section-summary' >Attributes: <span>(24)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>Intensity</dd><dt><span>lagtime :</span></dt><dd>sec</dd><dt><span>q :</span></dt><dd>μm$^{-1}$</dd><dt><span>x :</span></dt><dd>pixels</dd><dt><span>y :</span></dt><dd>pixels</dd><dt><span>info :</span></dt><dd>ddm_matrix is the averages of FFT difference images, ravs are the radial averages</dd><dt><span>BackgroundMethod :</span></dt><dd>None</dd><dt><span>OverlapMethod :</span></dt><dd>2</dd><dt><span>DataDirectory :</span></dt><dd>C:/Users/rmcgorty/Documents/GitHub/PyDDM/Examples/</dd><dt><span>FileName :</span></dt><dd>images_nobin_40x_128x128_8bit.tif</dd><dt><span>pixel_size :</span></dt><dd>0.242</dd><dt><span>frame_rate :</span></dt><dd>41.7</dd><dt><span>starting_frame_number :</span></dt><dd>no</dd><dt><span>ending_frame_number :</span></dt><dd>no</dd><dt><span>number_lagtimes :</span></dt><dd>40</dd><dt><span>first_lag_time :</span></dt><dd>yes</dd><dt><span>last_lag_time :</span></dt><dd>600</dd><dt><span>crop_to_roi :</span></dt><dd>no</dd><dt><span>split_into_4_rois :</span></dt><dd>no</dd><dt><span>use_windowing_function :</span></dt><dd>no</dd><dt><span>binning :</span></dt><dd>no</dd><dt><span>bin_size :</span></dt><dd>2</dd><dt><span>central_angle :</span></dt><dd>no</dd><dt><span>angle_range :</span></dt><dd>no</dd></dl></div></li></ul></div></div></div>
</div>
<p>Now let’s save this <code class="docutils literal notranslate"><span class="pre">ddm_dataset</span></code>. When the <code class="docutils literal notranslate"><span class="pre">calculate_DDM_matrix</span></code> method is executed, the <code class="docutils literal notranslate"><span class="pre">ddm_dataset</span></code> is automatically saved to disk. But we can overwrite that with the <code class="docutils literal notranslate"><span class="pre">resave_ddm_dataset</span></code> method.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddm_calc</span><span class="o">.</span><span class="n">resave_ddm_dataset</span><span class="p">(</span><span class="n">new_ddm_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Additional-notes-about-the-background">
<h4>Additional notes about the background<a class="headerlink" href="#Additional-notes-about-the-background" title="Link to this heading">#</a></h4>
<p>The default way that <strong>this</strong> code estimates the background is to compute the power spectrum of the images, as described above. That is, we find <span class="math notranslate nohighlight">\(\left&lt; | \tilde{I}(q, t) |^2 \right&gt;_t\)</span> and recognize that <span class="math notranslate nohighlight">\(\left&lt; | \tilde{I}(q, t) |^2 \right&gt;_t = 0.5 \times \left[ A(q) + B \right]\)</span> and assume that as <span class="math notranslate nohighlight">\(q \rightarrow q_{max}\)</span>, <span class="math notranslate nohighlight">\(A(q) \rightarrow 0\)</span>. Therefore, <span class="math notranslate nohighlight">\(\left&lt; | \tilde{I}(q_{max}, t) |^2 \right&gt;_t \approx 0.5\times B\)</span> (see [<strong>Cerbino 2017</strong>] or Eq. 5 in
[<strong>Giavazzi 2018</strong>]).</p>
<p>But, there are other ways. In [<strong>Kurzthaler 2018</strong>], they set the background, <span class="math notranslate nohighlight">\(B\)</span>, to zero. They note that for their fluorescence imaging “the camera noise is usually negligible.” However, they note that for bright-field of phase contrast modalities, the camera is not negligible and <span class="math notranslate nohighlight">\(B\)</span> will be non-zero.</p>
<p>In [<strong>Bayles 2017</strong>], they approximate <span class="math notranslate nohighlight">\(B\)</span> by <span class="math notranslate nohighlight">\(\min \left[ D(q, \Delta t_{min}) \right]\)</span>. But they note that the frame rate needs to be “sufficiently small” and that this will give an overestimate of <span class="math notranslate nohighlight">\(B\)</span>. To try this, use <code class="docutils literal notranslate"><span class="pre">background_method</span> <span class="pre">=</span> <span class="pre">1</span></code> as an optional keyword parameter in the function <code class="docutils literal notranslate"><span class="pre">calculate_DDM_matrix</span></code> (or set the value of <code class="docutils literal notranslate"><span class="pre">background_method</span></code> in the YAML file under <code class="docutils literal notranslate"><span class="pre">Analysis_parameters</span></code>).</p>
<blockquote>
<div><p>[<strong>Cerbino 2017</strong>] Cerbino, R., Piotti, D., Buscaglia, M. &amp; Giavazzi, F. <a class="reference external" href="https://doi.org/10.1088/1361-648X/aa9bc5">Dark field differential dynamic microscopy enables accurate characterization of the roto-translational dynamics of bacteria and colloidal clusters.</a> J. Phys.: Condens. Matter 30, 025901 (2017).</p>
</div></blockquote>
<blockquote>
<div><p>[<strong>Giavazzi 2018</strong>] Giavazzi, F., Malinverno, C., Scita, G. &amp; Cerbino, R. <a class="reference external" href="https://doi.org/10.3389/fphy.2018.00120">Tracking-Free Determination of Single-Cell Displacements and Division Rates in Confluent Monolayers.</a> Front. Phys. 6, (2018).</p>
<p>[<strong>Kurzthaler 2018</strong>] Kurzthaler, C. et al. <a class="reference external" href="https://doi.org/10.1103/PhysRevLett.121.078001">Probing the Spatiotemporal Dynamics of Catalytic Janus Particles with Single-Particle Tracking and Differential Dynamic Microscopy.</a> Phys. Rev. Lett. 121, 078001 (2018).</p>
</div></blockquote>
<blockquote>
<div><p>[<strong>Bayles 2017</strong>] Bayles, A. V., Squires, T. M. &amp; Helgeson, M. E. <a class="reference external" href="https://doi.org/10.1007/s00397-017-1047-7">Probe microrheology without particle tracking by differential dynamic microscopy.</a> Rheol Acta 56, 863–869 (2017).</p>
</div></blockquote>
</section>
</section>
</section>
<section id="Initiazing-DDM_Fit-class-and-fitting-our-data-to-a-model">
<h2>Initiazing DDM_Fit class and fitting our data to a model<a class="headerlink" href="#Initiazing-DDM_Fit-class-and-fitting-our-data-to-a-model" title="Link to this heading">#</a></h2>
<p>We initlize the <code class="docutils literal notranslate"><span class="pre">DDM_Fit</span></code> class by passing it the yaml file containing our analysis parameters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Note that to initialize the DDM_Fit class we need to pass it the YAML file containing the parameters</span>
<span class="c1"># *or* a dictionary with the same parameters.</span>

<span class="n">ddm_fit</span> <span class="o">=</span> <span class="n">ddm</span><span class="o">.</span><span class="n">DDM_Fit</span><span class="p">(</span><span class="n">ddm_calc</span><span class="o">.</span><span class="n">data_yaml</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Initial guess</th>
      <th>Minimum</th>
      <th>Maximum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Amplitude</th>
      <td>100.0</td>
      <td>1.000</td>
      <td>1000000.0</td>
    </tr>
    <tr>
      <th>Tau</th>
      <td>1.0</td>
      <td>0.001</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>Background</th>
      <td>25000.0</td>
      <td>0.000</td>
      <td>10000000.0</td>
    </tr>
    <tr>
      <th>StretchingExp</th>
      <td>1.0</td>
      <td>0.500</td>
      <td>1.1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Loading file C:/Users/rmcgorty/Documents/GitHub/PyDDM/Examples/images_nobin_40x_128x128_8bit_ddmmatrix.nc ...
</pre></div></div>
</div>
<p>Based on what was done above in terms of estimating the background, we found that <span class="math notranslate nohighlight">\(B\)</span> should be about 190. We use that estimate of the background to determine <span class="math notranslate nohighlight">\(A(q)\)</span> and the intermediate scattering function, <span class="math notranslate nohighlight">\(f(q,\Delta t)\)</span>. We could proceed to then fit the ISF. But here we choose not to. We fit the DDM matrix and have the amplitude and background, <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>, be fitting parameters. But we can constrain these parameters based on what we found above.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#We update the intial guess for the background and the lower and upper bounds</span>
<span class="n">ddm_fit</span><span class="o">.</span><span class="n">set_parameter_initial_guess</span><span class="p">(</span><span class="s1">&#39;Background&#39;</span><span class="p">,</span> <span class="mi">190</span><span class="p">)</span>
<span class="n">ddm_fit</span><span class="o">.</span><span class="n">set_parameter_bounds</span><span class="p">(</span><span class="s1">&#39;Background&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">220</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Parameter &#39;Background&#39; set to 190.
Parameter &#39;Background&#39; lower limit set to 10.
Parameter &#39;Background&#39; upper limit set to 220.
</pre></div></div>
</div>
<section id="Our-first-attemp-at-fitting-the-data">
<h3>Our first attemp at fitting the data<a class="headerlink" href="#Our-first-attemp-at-fitting-the-data" title="Link to this heading">#</a></h3>
<p>When we execute the fit below, we can use the optional argument <code class="docutils literal notranslate"><span class="pre">use_A_from_images_as_guess</span></code> set to True. This will use the value of <span class="math notranslate nohighlight">\(A(q)\)</span> we esimated from the average Fourier tranform of all images and the estimated background. We can further limit the bounds on <span class="math notranslate nohighlight">\(A(q)\)</span> with the optional parameter <code class="docutils literal notranslate"><span class="pre">update_limits_on_A</span></code> set to True. This will restrict the range that <span class="math notranslate nohighlight">\(A(q)\)</span> can take to be within 10% of the estimated <span class="math notranslate nohighlight">\(A(q)\)</span>. If we want the bounds to be stricter or looser
than 10%, we can change the optional parameter <code class="docutils literal notranslate"><span class="pre">updated_lims_on_A_fraction</span></code> to be something other than 0.1 (the default).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Note that the method `fit` has many optional parameters</span>

<span class="n">fit01</span> <span class="o">=</span> <span class="n">ddm_fit</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">name_fit</span> <span class="o">=</span> <span class="s1">&#39;fit01&#39;</span><span class="p">,</span> <span class="n">display_table</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_A_from_images_as_guess</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_limits_on_A</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
In function &#39;get_tau_vs_q_fit&#39;, using new tau...
Fit is saved in fittings dictionary with key &#39;fit01&#39;.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Generate plots for inspecting the outcome of the fits</span>

<span class="n">ddm</span><span class="o">.</span><span class="n">fit_report</span><span class="p">(</span><span class="n">fit01</span><span class="p">,</span> <span class="n">q_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">22</span><span class="p">],</span> <span class="n">forced_qs</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span> <span class="n">use_new_tau</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
In function &#39;get_tau_vs_q_fit&#39;, using new tau...
In hf.plot_one_tau_vs_q function, using new tau...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:          (parameter: 4, q: 64, lagtime: 40)
Coordinates:
  * parameter        (parameter) &lt;U13 &#x27;Amplitude&#x27; &#x27;Tau&#x27; ... &#x27;StretchingExp&#x27;
  * q                (q) float64 0.0 0.2028 0.4057 0.6085 ... 12.37 12.58 12.78
  * lagtime          (lagtime) float64 0.02398 0.04796 0.07194 ... 12.59 14.36
Data variables:
    parameters       (parameter, q) float64 1.0 2.326e+05 ... 0.705 0.7446
    theory           (lagtime, q) float64 10.0 315.0 338.5 ... 206.7 206.8 206.9
    isf_data         (lagtime, q) float64 0.0 0.9996 0.9872 ... 0.432 0.4966
    ddm_matrix_data  (lagtime, q) float64 0.0 294.2 321.4 ... 207.8 201.1 200.4
    A                (q) float64 -190.0 2.585e+05 1.026e+04 ... 19.47 20.65
    B                int32 190
Attributes: (12/18)
    model:                          DDM Matrix - Single Exponential
    data_to_use:                    DDM Matrix
    initial_params_dict:            [&quot;{&#x27;n&#x27;: 0, &#x27;value&#x27;: 100.0, &#x27;limits&#x27;: [1.0...
    effective_diffusion_coeff:      0.6168642315520588
    tau_vs_q_slope:                 [-1.98005917]
    msd_alpha:                      [1.01007082]
    ...                             ...
    DataDirectory:                  C:/Users/rmcgorty/Documents/GitHub/PyDDM/...
    FileName:                       images_nobin_40x_128x128_8bit.tif
    pixel_size:                     0.242
    frame_rate:                     41.7
    BackgroundMethod:               None
    OverlapMethod:                  2</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-47e2e60b-d87a-46b5-b014-61a5b7197ee9' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-47e2e60b-d87a-46b5-b014-61a5b7197ee9' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>parameter</span>: 4</li><li><span class='xr-has-index'>q</span>: 64</li><li><span class='xr-has-index'>lagtime</span>: 40</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-86012f90-6c17-4b11-940d-09f1d7afff6b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-86012f90-6c17-4b11-940d-09f1d7afff6b' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>parameter</span></div><div class='xr-var-dims'>(parameter)</div><div class='xr-var-dtype'>&lt;U13</div><div class='xr-var-preview xr-preview'>&#x27;Amplitude&#x27; ... &#x27;StretchingExp&#x27;</div><input id='attrs-21f6cc8c-e988-4e2a-a766-624ee0414633' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-21f6cc8c-e988-4e2a-a766-624ee0414633' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-620bd27d-0817-485b-a33e-1d818caa9328' class='xr-var-data-in' type='checkbox'><label for='data-620bd27d-0817-485b-a33e-1d818caa9328' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;Amplitude&#x27;, &#x27;Tau&#x27;, &#x27;Background&#x27;, &#x27;StretchingExp&#x27;], dtype=&#x27;&lt;U13&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>q</span></div><div class='xr-var-dims'>(q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.2028 0.4057 ... 12.58 12.78</div><input id='attrs-06dc6c06-f5c1-4c2b-9662-242af89355d3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-06dc6c06-f5c1-4c2b-9662-242af89355d3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-127d1663-2a41-452c-aa6d-44e2ab864130' class='xr-var-data-in' type='checkbox'><label for='data-127d1663-2a41-452c-aa6d-44e2ab864130' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0.      ,  0.20284 ,  0.405681,  0.608521,  0.811362,  1.014202,
        1.217043,  1.419883,  1.622723,  1.825564,  2.028404,  2.231245,
        2.434085,  2.636926,  2.839766,  3.042607,  3.245447,  3.448287,
        3.651128,  3.853968,  4.056809,  4.259649,  4.46249 ,  4.66533 ,
        4.86817 ,  5.071011,  5.273851,  5.476692,  5.679532,  5.882373,
        6.085213,  6.288053,  6.490894,  6.693734,  6.896575,  7.099415,
        7.302256,  7.505096,  7.707937,  7.910777,  8.113617,  8.316458,
        8.519298,  8.722139,  8.924979,  9.12782 ,  9.33066 ,  9.5335  ,
        9.736341,  9.939181, 10.142022, 10.344862, 10.547703, 10.750543,
       10.953383, 11.156224, 11.359064, 11.561905, 11.764745, 11.967586,
       12.170426, 12.373267, 12.576107, 12.778947])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lagtime</span></div><div class='xr-var-dims'>(lagtime)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02398 0.04796 ... 12.59 14.36</div><input id='attrs-8903651e-79fc-4ebd-8e6b-9be11ae953fe' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8903651e-79fc-4ebd-8e6b-9be11ae953fe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3619c601-c252-4343-bd72-671cf92421cc' class='xr-var-data-in' type='checkbox'><label for='data-3619c601-c252-4343-bd72-671cf92421cc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0.023981,  0.047962,  0.071942,  0.095923,  0.119904,  0.143885,
        0.167866,  0.191847,  0.215827,  0.263789,  0.28777 ,  0.335731,
        0.383693,  0.431655,  0.503597,  0.57554 ,  0.647482,  0.743405,
        0.863309,  0.983213,  1.127098,  1.294964,  1.486811,  1.702638,
        1.942446,  2.206235,  2.541966,  2.901679,  3.309353,  3.788969,
        4.316547,  4.940048,  5.659472,  6.450839,  7.386091,  8.441247,
        9.640288, 11.007194, 12.589928, 14.364508])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-01f9c352-5a70-431d-bc24-c35cce0dc937' class='xr-section-summary-in' type='checkbox'  checked><label for='section-01f9c352-5a70-431d-bc24-c35cce0dc937' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>parameters</span></div><div class='xr-var-dims'>(parameter, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 2.326e+05 ... 0.705 0.7446</div><input id='attrs-b81b69e4-0eed-48d1-9054-51ee23fa3706' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b81b69e4-0eed-48d1-9054-51ee23fa3706' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-88aa3a69-48bd-415e-a881-4ae3d401bf2b' class='xr-var-data-in' type='checkbox'><label for='data-88aa3a69-48bd-415e-a881-4ae3d401bf2b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1.00000000e+00, 2.32643716e+05, 9.23421116e+03, 1.04425917e+04,
        1.65958488e+04, 1.87741627e+04, 2.01262093e+04, 2.02699356e+04,
        1.93938141e+04, 2.14281346e+04, 2.33743051e+04, 2.74778139e+04,
        3.34522708e+04, 3.95131276e+04, 4.17820421e+04, 4.20664112e+04,
        4.07569060e+04, 3.57098235e+04, 2.84201318e+04, 2.06082054e+04,
        1.43591503e+04, 9.28277724e+03, 5.65119988e+03, 3.47725293e+03,
        2.06716941e+03, 1.22311564e+03, 8.76927421e+02, 6.90124480e+02,
        5.35443212e+02, 3.89510499e+02, 3.09479117e+02, 2.84955892e+02,
        2.38546284e+02, 1.83561135e+02, 1.54020959e+02, 1.19441061e+02,
        9.04713776e+01, 7.32803000e+01, 6.33150620e+01, 5.96873022e+01,
        5.24361145e+01, 5.22937881e+01, 4.71960269e+01, 4.33385126e+01,
        4.05167159e+01, 3.65581811e+01, 3.64825249e+01, 3.16307736e+01,
        3.03294115e+01, 3.01774381e+01, 2.74449201e+01, 2.64654033e+01,
        2.49019252e+01, 2.63921992e+01, 2.44762177e+01, 2.29111548e+01,
        2.30207207e+01, 2.14327020e+01, 2.16657687e+01, 1.97674044e+01,
        1.82254698e+01, 1.85635203e+01, 1.75272833e+01, 1.85882970e+01],
       [1.00000000e+01, 1.00000000e+01, 1.00000000e+01, 3.86806763e+00,
        2.55606871e+00, 1.42436450e+00, 1.03553610e+00, 7.42218975e-01,
        5.52015441e-01, 4.65091456e-01, 3.96220641e-01, 3.21261104e-01,
        2.90633158e-01, 2.48487749e-01, 2.13902731e-01, 1.92959729e-01,
...
        1.88872932e+02, 1.88581861e+02, 1.89252080e+02, 1.88386083e+02,
        1.88981350e+02, 1.87924484e+02, 1.87679912e+02, 1.87688222e+02,
        1.87969231e+02, 1.87747866e+02, 1.88648024e+02, 1.89106434e+02,
        1.89427805e+02, 1.88135686e+02, 1.89288727e+02, 1.88358949e+02],
       [1.10000000e+00, 1.10000000e+00, 5.61916398e-01, 7.10762250e-01,
        8.11577778e-01, 9.09132560e-01, 9.11750595e-01, 9.52912598e-01,
        9.57434030e-01, 9.79312824e-01, 9.69590565e-01, 1.00961966e+00,
        1.01501443e+00, 1.04072569e+00, 1.03076437e+00, 1.03128893e+00,
        1.04638759e+00, 1.04446796e+00, 1.04406777e+00, 1.05492850e+00,
        1.03622512e+00, 1.02767912e+00, 1.01091421e+00, 9.75980332e-01,
        9.19591679e-01, 9.11770097e-01, 8.60156028e-01, 8.59201102e-01,
        7.98604397e-01, 7.94550993e-01, 7.81941075e-01, 7.57373189e-01,
        7.63314218e-01, 7.33617919e-01, 6.92531764e-01, 6.47957554e-01,
        6.96849842e-01, 7.07400255e-01, 7.43780117e-01, 6.79390232e-01,
        7.06264342e-01, 6.76778617e-01, 6.50957583e-01, 6.69603282e-01,
        6.90556765e-01, 6.62360386e-01, 7.05250808e-01, 6.76426769e-01,
        7.21412072e-01, 7.22245349e-01, 6.46001050e-01, 6.55461922e-01,
        6.71431019e-01, 6.24491328e-01, 6.21572597e-01, 6.59109603e-01,
        6.24070701e-01, 6.10418310e-01, 6.90625300e-01, 6.72248157e-01,
        7.68715009e-01, 7.20353863e-01, 7.04971605e-01, 7.44597078e-01]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>theory</span></div><div class='xr-var-dims'>(lagtime, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>10.0 315.0 338.5 ... 206.8 206.9</div><input id='attrs-531a720b-a557-476f-9087-01c0d93781db' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-531a720b-a557-476f-9087-01c0d93781db' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3fefbc66-04b4-47c4-9eb5-493b83577ed0' class='xr-var-data-in' type='checkbox'><label for='data-3fefbc66-04b4-47c4-9eb5-493b83577ed0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1.00013109e+01, 3.14969814e+02, 3.38493932e+02, ...,
        1.92529023e+02, 1.93101914e+02, 1.92287259e+02],
       [1.00028078e+01, 6.63227156e+02, 4.80661006e+02, ...,
        1.94802592e+02, 1.95066214e+02, 1.94459478e+02],
       [1.00043826e+01, 1.02958077e+03, 5.91814578e+02, ...,
        1.96469200e+02, 1.96522549e+02, 1.96093000e+02],
       ...,
       [1.06708801e+01, 1.56086044e+05, 6.05266368e+03, ...,
        2.06699206e+02, 2.06816010e+02, 2.06947246e+02],
       [1.07242679e+01, 1.68506368e+05, 6.30794233e+03, ...,
        2.06699206e+02, 2.06816010e+02, 2.06947246e+02],
       [1.07744986e+01, 1.80192244e+05, 6.55592511e+03, ...,
        2.06699206e+02, 2.06816010e+02, 2.06947246e+02]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>isf_data</span></div><div class='xr-var-dims'>(lagtime, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.9996 0.9872 ... 0.432 0.4966</div><input id='attrs-435f0f44-14d1-41f2-9108-053de5ee48ef' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-435f0f44-14d1-41f2-9108-053de5ee48ef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fdbe4291-5ad1-4e4a-a3b7-0420ada976d8' class='xr-var-data-in' type='checkbox'><label for='data-fdbe4291-5ad1-4e4a-a3b7-0420ada976d8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 0.        ,  0.99959694,  0.9871915 , ...,  0.85778634,
         0.82204821,  0.86604236],
       [ 0.        ,  0.99906358,  0.97066658, ...,  0.76497186,
         0.7397658 ,  0.78674034],
       [ 0.        ,  0.99866393,  0.95809464, ...,  0.70299025,
         0.6810774 ,  0.71946869],
       ...,
       [ 0.        ,  0.98539009,  0.4540191 , ...,  0.27275862,
        -0.09683656, -0.09489651],
       [ 0.        ,  0.98461401,  0.4867419 , ...,  0.32901286,
         0.21002625,  0.13879852],
       [ 0.        ,  0.98635641,  0.42712011, ...,  0.13873015,
         0.43195264,  0.49663365]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ddm_matrix_data</span></div><div class='xr-var-dims'>(lagtime, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 294.2 321.4 ... 201.1 200.4</div><input id='attrs-719243b2-3be8-461e-b032-927a4a9c2912' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-719243b2-3be8-461e-b032-927a4a9c2912' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9e6eed76-b6d8-4c4d-ac5f-68e9c81fb49b' class='xr-var-data-in' type='checkbox'><label for='data-9e6eed76-b6d8-4c4d-ac5f-68e9c81fb49b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[   0.        ,  294.18943955,  321.41822078, ...,  192.93331805,
         193.46556826,  192.76671589],
       [   0.        ,  432.05714374,  490.9677582 , ...,  194.84772175,
         195.06799833,  194.40459328],
       [   0.        ,  535.36374381,  619.95883018, ...,  196.12616285,
         196.21094092,  195.79399928],
       ...,
       [   0.        , 3966.56056507, 5791.89215548, ...,  205.00017796,
         211.36062787,  212.61362392],
       [   0.        , 4167.1712352 , 5456.14848464, ...,  203.8398704 ,
         205.38454854,  207.78696548],
       [   0.        , 3716.77402137, 6067.88205869, ...,  207.76466695,
         201.06258553,  200.39635905]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>A</span></div><div class='xr-var-dims'>(q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-190.0 2.585e+05 ... 19.47 20.65</div><input id='attrs-059c66c9-3b6a-4da1-b924-2c585ef60638' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-059c66c9-3b6a-4da1-b924-2c585ef60638' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-81feb072-ecb9-41be-9f10-d6aac9ad3340' class='xr-var-data-in' type='checkbox'><label for='data-81feb072-ecb9-41be-9f10-d6aac9ad3340' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-1.90000000e+02,  2.58493018e+05,  1.02602346e+04,  1.15497914e+04,
        1.68195629e+04,  1.91789308e+04,  1.97920750e+04,  2.04739243e+04,
        1.98628174e+04,  2.14217457e+04,  2.30787136e+04,  2.75439244e+04,
        3.36077443e+04,  3.95384367e+04,  4.21701356e+04,  4.26722045e+04,
        4.10361202e+04,  3.58616144e+04,  2.83223278e+04,  2.06264656e+04,
        1.43607517e+04,  9.18098831e+03,  5.57030056e+03,  3.36316630e+03,
        1.93279536e+03,  1.17701023e+03,  8.05816138e+02,  6.46477276e+02,
        4.86766556e+02,  3.54100454e+02,  2.81344652e+02,  2.59050811e+02,
        2.16860258e+02,  1.66873759e+02,  1.40019053e+02,  1.08582782e+02,
        9.24025916e+01,  7.62421017e+01,  6.95296420e+01,  6.63192247e+01,
        5.82623495e+01,  5.81042089e+01,  5.24400299e+01,  4.81539029e+01,
        4.50185732e+01,  4.06202012e+01,  4.05361388e+01,  3.51453041e+01,
        3.36993461e+01,  3.35304868e+01,  3.04943557e+01,  2.94060037e+01,
        2.76688057e+01,  2.93246657e+01,  2.71957975e+01,  2.54568387e+01,
        2.55785786e+01,  2.38141133e+01,  2.40730764e+01,  2.19637827e+01,
        2.02505220e+01,  2.06261336e+01,  1.94747592e+01,  2.06536633e+01])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>B</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>190</div><input id='attrs-45e52dd9-62a2-4553-ad08-45414c95e7e1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-45e52dd9-62a2-4553-ad08-45414c95e7e1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b53c1114-e40a-4e6d-97cd-92f6bc05dc1d' class='xr-var-data-in' type='checkbox'><label for='data-b53c1114-e40a-4e6d-97cd-92f6bc05dc1d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(190)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-75f65c34-e7c4-4d77-a532-a2873b367f68' class='xr-section-summary-in' type='checkbox'  ><label for='section-75f65c34-e7c4-4d77-a532-a2873b367f68' class='xr-section-summary' >Attributes: <span>(18)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>model :</span></dt><dd>DDM Matrix - Single Exponential</dd><dt><span>data_to_use :</span></dt><dd>DDM Matrix</dd><dt><span>initial_params_dict :</span></dt><dd>[&quot;{&#x27;n&#x27;: 0, &#x27;value&#x27;: 100.0, &#x27;limits&#x27;: [1.0, 1000000.0], &#x27;limited&#x27;: [True, True], &#x27;fixed&#x27;: False, &#x27;parname&#x27;: &#x27;Amplitude&#x27;, &#x27;error&#x27;: 0, &#x27;step&#x27;: 0}&quot;, &quot;{&#x27;n&#x27;: 1, &#x27;value&#x27;: 1.0, &#x27;limits&#x27;: [0.001, 10.0], &#x27;limited&#x27;: [True, True], &#x27;fixed&#x27;: False, &#x27;parname&#x27;: &#x27;Tau&#x27;, &#x27;error&#x27;: 0, &#x27;step&#x27;: 0}&quot;, &quot;{&#x27;n&#x27;: 2, &#x27;value&#x27;: 190.0, &#x27;limits&#x27;: [10.0, 220.0], &#x27;limited&#x27;: [True, True], &#x27;fixed&#x27;: False, &#x27;parname&#x27;: &#x27;Background&#x27;, &#x27;error&#x27;: 0, &#x27;step&#x27;: 0}&quot;, &quot;{&#x27;n&#x27;: 3, &#x27;value&#x27;: 1.0, &#x27;limits&#x27;: [0.5, 1.1], &#x27;limited&#x27;: [True, True], &#x27;fixed&#x27;: False, &#x27;parname&#x27;: &#x27;StretchingExp&#x27;, &#x27;error&#x27;: 0, &#x27;step&#x27;: 0}&quot;]</dd><dt><span>effective_diffusion_coeff :</span></dt><dd>0.6168642315520588</dd><dt><span>tau_vs_q_slope :</span></dt><dd>[-1.98005917]</dd><dt><span>msd_alpha :</span></dt><dd>[1.01007082]</dd><dt><span>msd_effective_diffusion_coeff :</span></dt><dd>[0.6138703]</dd><dt><span>diffusion_coeff :</span></dt><dd>0.6104877159595499</dd><dt><span>diffusion_coeff_std :</span></dt><dd>0.04076205720351696</dd><dt><span>velocity :</span></dt><dd>1.0541545094734308</dd><dt><span>velocity_std :</span></dt><dd>0.41611807499452924</dd><dt><span>good_q_range :</span></dt><dd>[4, 16]</dd><dt><span>DataDirectory :</span></dt><dd>C:/Users/rmcgorty/Documents/GitHub/PyDDM/Examples/</dd><dt><span>FileName :</span></dt><dd>images_nobin_40x_128x128_8bit.tif</dd><dt><span>pixel_size :</span></dt><dd>0.242</dd><dt><span>frame_rate :</span></dt><dd>41.7</dd><dt><span>BackgroundMethod :</span></dt><dd>None</dd><dt><span>OverlapMethod :</span></dt><dd>2</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_42_2.png" src="_images/Walkthrough_-_details_42_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_42_3.png" src="_images/Walkthrough_-_details_42_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_42_4.png" src="_images/Walkthrough_-_details_42_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_42_5.png" src="_images/Walkthrough_-_details_42_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_42_6.png" src="_images/Walkthrough_-_details_42_6.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_42_7.png" src="_images/Walkthrough_-_details_42_7.png" />
</div>
</div>
</section>
<section id="Our-second-attemp-at-fitting-the-data---updating-initial-guesses-for-tau">
<h3>Our second attemp at fitting the data - updating initial guesses for tau<a class="headerlink" href="#Our-second-attemp-at-fitting-the-data---updating-initial-guesses-for-tau" title="Link to this heading">#</a></h3>
<p>From the results of the fit, we can estimate a diffusion coefficient of about 0.6 <span class="math notranslate nohighlight">\(\mu m^2 / s\)</span>. We determine this by looking at the characteristic decay time vs the wavevector (<span class="math notranslate nohighlight">\(\tau\)</span> vs <span class="math notranslate nohighlight">\(q\)</span>). On a log-log plot, power laws relationships between the two variables will come across as a straight line where the slope of the line is equal to the power. And, for this data, we see a clear power law show a relationship of <span class="math notranslate nohighlight">\(\tau \propto q^{-2}\)</span> which indicates diffusive motion.
Note that our data deviates from this power law relationship for <span class="math notranslate nohighlight">\(q\)</span> greater than about 4 <span class="math notranslate nohighlight">\(\mu m^{-1}\)</span>. This could be due to poor optical resolution limiting the high wavevectors (which correspond to small length scales). Or it could be due to not having the temporal resolution necessary to detect fast decay times. Lastly, it could also be due to poor fit performance. We could try to use an initial guess for <span class="math notranslate nohighlight">\(\tau\)</span> for each <span class="math notranslate nohighlight">\(q\)</span> that is based on an estimated diffusion
coefficient. That is, when we fit <span class="math notranslate nohighlight">\(D(q, \Delta t)\)</span> (or <span class="math notranslate nohighlight">\(f(q,\Delta t)\)</span>), for each <span class="math notranslate nohighlight">\(q\)</span>, we will calculate <span class="math notranslate nohighlight">\(\tau_{guess} = 1 / (Dq^2)\)</span> and use that as the initial guess in the fits. We do that below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit02</span> <span class="o">=</span> <span class="n">ddm_fit</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">name_fit</span> <span class="o">=</span> <span class="s1">&#39;fit02&#39;</span><span class="p">,</span> <span class="n">display_table</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_A_from_images_as_guess</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_limits_on_A</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">update_tau_based_on_estimated_diffcoeff</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">estimated_diffcoeff</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                   <span class="n">update_limits_on_tau</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">updated_lims_on_tau_fraction</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
In function &#39;get_tau_vs_q_fit&#39;, using new tau...
Fit is saved in fittings dictionary with key &#39;fit02&#39;.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddm</span><span class="o">.</span><span class="n">fit_report</span><span class="p">(</span><span class="n">fit02</span><span class="p">,</span> <span class="n">q_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">22</span><span class="p">],</span> <span class="n">forced_qs</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span> <span class="n">use_new_tau</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:          (parameter: 4, q: 64, lagtime: 40)
Coordinates:
  * parameter        (parameter) &lt;U13 &#x27;Amplitude&#x27; &#x27;Tau&#x27; ... &#x27;StretchingExp&#x27;
  * q                (q) float64 0.0 0.2028 0.4057 0.6085 ... 12.37 12.58 12.78
  * lagtime          (lagtime) float64 0.02398 0.04796 0.07194 ... 12.59 14.36
Data variables:
    parameters       (parameter, q) float64 1.0 2.326e+05 9.894e+03 ... 0.5 0.5
    theory           (lagtime, q) float64 10.0 152.4 361.6 ... 202.0 201.7 201.6
    isf_data         (lagtime, q) float64 0.0 0.9996 0.9872 ... 0.432 0.4966
    ddm_matrix_data  (lagtime, q) float64 0.0 294.2 321.4 ... 207.8 201.1 200.4
    A                (q) float64 -190.0 2.585e+05 1.026e+04 ... 19.47 20.65
    B                int32 190
Attributes: (12/18)
    model:                          DDM Matrix - Single Exponential
    data_to_use:                    DDM Matrix
    initial_params_dict:            [&quot;{&#x27;n&#x27;: 0, &#x27;value&#x27;: 100.0, &#x27;limits&#x27;: [1.0...
    effective_diffusion_coeff:      0.6584064996820138
    tau_vs_q_slope:                 [-1.89886818]
    msd_alpha:                      [1.053259]
    ...                             ...
    DataDirectory:                  C:/Users/rmcgorty/Documents/GitHub/PyDDM/...
    FileName:                       images_nobin_40x_128x128_8bit.tif
    pixel_size:                     0.242
    frame_rate:                     41.7
    BackgroundMethod:               None
    OverlapMethod:                  2</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-8beacef4-eff2-4f87-bc39-f7ff97ffd10e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8beacef4-eff2-4f87-bc39-f7ff97ffd10e' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>parameter</span>: 4</li><li><span class='xr-has-index'>q</span>: 64</li><li><span class='xr-has-index'>lagtime</span>: 40</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-6e860ed1-c67a-41f1-b458-c9b180640a85' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6e860ed1-c67a-41f1-b458-c9b180640a85' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>parameter</span></div><div class='xr-var-dims'>(parameter)</div><div class='xr-var-dtype'>&lt;U13</div><div class='xr-var-preview xr-preview'>&#x27;Amplitude&#x27; ... &#x27;StretchingExp&#x27;</div><input id='attrs-581c13c8-9533-493e-a730-2c5de1bef035' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-581c13c8-9533-493e-a730-2c5de1bef035' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b1c0b2e3-e3b7-4fc0-a609-b84a387dea3a' class='xr-var-data-in' type='checkbox'><label for='data-b1c0b2e3-e3b7-4fc0-a609-b84a387dea3a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;Amplitude&#x27;, &#x27;Tau&#x27;, &#x27;Background&#x27;, &#x27;StretchingExp&#x27;], dtype=&#x27;&lt;U13&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>q</span></div><div class='xr-var-dims'>(q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.2028 0.4057 ... 12.58 12.78</div><input id='attrs-309a65aa-b2c8-486e-8896-e48921718c02' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-309a65aa-b2c8-486e-8896-e48921718c02' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dd8a795e-d62f-4b90-ac45-7c3a589ef87e' class='xr-var-data-in' type='checkbox'><label for='data-dd8a795e-d62f-4b90-ac45-7c3a589ef87e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0.      ,  0.20284 ,  0.405681,  0.608521,  0.811362,  1.014202,
        1.217043,  1.419883,  1.622723,  1.825564,  2.028404,  2.231245,
        2.434085,  2.636926,  2.839766,  3.042607,  3.245447,  3.448287,
        3.651128,  3.853968,  4.056809,  4.259649,  4.46249 ,  4.66533 ,
        4.86817 ,  5.071011,  5.273851,  5.476692,  5.679532,  5.882373,
        6.085213,  6.288053,  6.490894,  6.693734,  6.896575,  7.099415,
        7.302256,  7.505096,  7.707937,  7.910777,  8.113617,  8.316458,
        8.519298,  8.722139,  8.924979,  9.12782 ,  9.33066 ,  9.5335  ,
        9.736341,  9.939181, 10.142022, 10.344862, 10.547703, 10.750543,
       10.953383, 11.156224, 11.359064, 11.561905, 11.764745, 11.967586,
       12.170426, 12.373267, 12.576107, 12.778947])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lagtime</span></div><div class='xr-var-dims'>(lagtime)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02398 0.04796 ... 12.59 14.36</div><input id='attrs-eb6cc77a-74b0-45ca-bd4f-5f06a0a4ff67' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-eb6cc77a-74b0-45ca-bd4f-5f06a0a4ff67' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8d8f0dd4-9060-4114-a3f4-8b1c9e26e8ce' class='xr-var-data-in' type='checkbox'><label for='data-8d8f0dd4-9060-4114-a3f4-8b1c9e26e8ce' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0.023981,  0.047962,  0.071942,  0.095923,  0.119904,  0.143885,
        0.167866,  0.191847,  0.215827,  0.263789,  0.28777 ,  0.335731,
        0.383693,  0.431655,  0.503597,  0.57554 ,  0.647482,  0.743405,
        0.863309,  0.983213,  1.127098,  1.294964,  1.486811,  1.702638,
        1.942446,  2.206235,  2.541966,  2.901679,  3.309353,  3.788969,
        4.316547,  4.940048,  5.659472,  6.450839,  7.386091,  8.441247,
        9.640288, 11.007194, 12.589928, 14.364508])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bae55faa-c316-4e87-8faa-249036a8ab63' class='xr-section-summary-in' type='checkbox'  checked><label for='section-bae55faa-c316-4e87-8faa-249036a8ab63' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>parameters</span></div><div class='xr-var-dims'>(parameter, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 2.326e+05 9.894e+03 ... 0.5 0.5</div><input id='attrs-0b4176e3-adc8-4ddf-bc30-9e30692b31ed' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0b4176e3-adc8-4ddf-bc30-9e30692b31ed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0604656f-77fb-4134-b9b7-36d46c5d8eaa' class='xr-var-data-in' type='checkbox'><label for='data-0604656f-77fb-4134-b9b7-36d46c5d8eaa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1.00000000e+00, 2.32643716e+05, 9.89373199e+03, 1.04425914e+04,
        1.65958403e+04, 1.87741626e+04, 2.01262063e+04, 2.02699350e+04,
        1.93938141e+04, 2.14281346e+04, 2.33743051e+04, 2.74778140e+04,
        3.34522708e+04, 3.95131276e+04, 4.17820422e+04, 4.20664111e+04,
        4.07569060e+04, 3.57098235e+04, 2.84201318e+04, 2.06082054e+04,
        1.43591503e+04, 9.28277724e+03, 5.65119988e+03, 3.47725293e+03,
        2.06716941e+03, 1.22311564e+03, 8.76927351e+02, 6.90124615e+02,
        5.35443212e+02, 3.89510499e+02, 3.09479117e+02, 2.84955892e+02,
        2.38546284e+02, 1.83561135e+02, 1.54020959e+02, 1.19441061e+02,
        1.01642851e+02, 8.38663118e+01, 7.64826062e+01, 7.29511472e+01,
        6.40885844e+01, 6.39146298e+01, 5.76840329e+01, 5.29692932e+01,
        4.95204305e+01, 4.46822213e+01, 4.45897527e+01, 3.86598345e+01,
        3.70692807e+01, 3.68835355e+01, 3.35437912e+01, 3.23466041e+01,
        3.04356863e+01, 3.22571323e+01, 2.99153772e+01, 2.80025225e+01,
        2.81364364e+01, 2.61955246e+01, 2.64803840e+01, 2.41601609e+01,
        2.22755742e+01, 2.26887470e+01, 2.14222352e+01, 2.27190297e+01],
       [1.00000000e+01, 8.10157916e+01, 1.53295774e+01, 3.86806746e+00,
        2.55606574e+00, 1.42436448e+00, 1.03553582e+00, 7.42218942e-01,
        5.52015441e-01, 4.65091456e-01, 3.96220640e-01, 3.21261107e-01,
        2.90633158e-01, 2.48487749e-01, 2.13902731e-01, 1.92959728e-01,
...
        1.75920784e+02, 1.75462434e+02, 1.77385444e+02, 1.77265516e+02,
        1.78234387e+02, 1.76044620e+02, 1.76896189e+02, 1.77554782e+02,
        1.77379772e+02, 1.78268340e+02, 1.78255143e+02, 1.79515166e+02,
        1.79915464e+02, 1.79294718e+02, 1.80274342e+02, 1.78884768e+02],
       [1.10000000e+00, 1.10000000e+00, 5.13758578e-01, 7.10762358e-01,
        8.11578193e-01, 9.09132572e-01, 9.11750832e-01, 9.52912637e-01,
        9.57434030e-01, 9.79312823e-01, 9.69590566e-01, 1.00961966e+00,
        1.01501443e+00, 1.04072569e+00, 1.03076437e+00, 1.03128894e+00,
        1.04638759e+00, 1.04446796e+00, 1.04406777e+00, 1.05492850e+00,
        1.03622512e+00, 1.02767912e+00, 1.01091421e+00, 9.75980332e-01,
        9.19591679e-01, 9.11770096e-01, 8.60156128e-01, 8.59200858e-01,
        7.98604406e-01, 7.94551000e-01, 7.81941080e-01, 7.57373234e-01,
        7.63314258e-01, 7.43304844e-01, 7.05794318e-01, 6.59952326e-01,
        6.13021408e-01, 5.87587545e-01, 5.74890649e-01, 5.32364098e-01,
        5.32295111e-01, 5.18818644e-01, 5.05445433e-01, 5.02325262e-01,
        5.10491451e-01, 5.00000000e-01, 5.05828686e-01, 5.00000000e-01,
        5.00000000e-01, 5.00000000e-01, 5.00000000e-01, 5.00000000e-01,
        5.00000000e-01, 5.00000000e-01, 5.00000000e-01, 5.00000000e-01,
        5.00000000e-01, 5.00000000e-01, 5.00000000e-01, 5.00000000e-01,
        5.00000000e-01, 5.00000000e-01, 5.00000000e-01, 5.00000000e-01]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>theory</span></div><div class='xr-var-dims'>(lagtime, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>10.0 152.4 361.6 ... 201.7 201.6</div><input id='attrs-01bc22c2-ce7a-47af-bbd9-48360da0ca74' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-01bc22c2-ce7a-47af-bbd9-48360da0ca74' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-13e98e34-428d-4cbf-921a-e2defa6e9ba9' class='xr-var-data-in' type='checkbox'><label for='data-13e98e34-428d-4cbf-921a-e2defa6e9ba9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1.00013109e+01, 1.52384616e+02, 3.61633798e+02, ...,
        1.94039740e+02, 1.94324216e+02, 1.93918518e+02],
       [1.00028078e+01, 1.87321112e+02, 5.08207808e+02, ...,
        1.96840289e+02, 1.96957227e+02, 1.96698370e+02],
       [1.00043826e+01, 2.24123965e+02, 6.19965793e+02, ...,
        1.98299076e+02, 1.98319989e+02, 1.98127945e+02],
       ...,
       [1.06708801e+01, 2.46219857e+04, 5.64750065e+03, ...,
        2.01983465e+02, 2.01696577e+02, 2.01603797e+02],
       [1.07242679e+01, 2.82783354e+04, 5.89647837e+03, ...,
        2.01983465e+02, 2.01696577e+02, 2.01603797e+02],
       [1.07744986e+01, 3.23548994e+04, 6.14246430e+03, ...,
        2.01983465e+02, 2.01696577e+02, 2.01603797e+02]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>isf_data</span></div><div class='xr-var-dims'>(lagtime, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.9996 0.9872 ... 0.432 0.4966</div><input id='attrs-683763e7-25d4-441a-812f-e77195de1b9c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-683763e7-25d4-441a-812f-e77195de1b9c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c88b6a1e-7ace-43c1-9f00-2d290298ddd1' class='xr-var-data-in' type='checkbox'><label for='data-c88b6a1e-7ace-43c1-9f00-2d290298ddd1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 0.        ,  0.99959694,  0.9871915 , ...,  0.85778634,
         0.82204821,  0.86604236],
       [ 0.        ,  0.99906358,  0.97066658, ...,  0.76497186,
         0.7397658 ,  0.78674034],
       [ 0.        ,  0.99866393,  0.95809464, ...,  0.70299025,
         0.6810774 ,  0.71946869],
       ...,
       [ 0.        ,  0.98539009,  0.4540191 , ...,  0.27275862,
        -0.09683656, -0.09489651],
       [ 0.        ,  0.98461401,  0.4867419 , ...,  0.32901286,
         0.21002625,  0.13879852],
       [ 0.        ,  0.98635641,  0.42712011, ...,  0.13873015,
         0.43195264,  0.49663365]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ddm_matrix_data</span></div><div class='xr-var-dims'>(lagtime, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 294.2 321.4 ... 201.1 200.4</div><input id='attrs-6519680c-dc56-4980-9be8-06e9c2aec087' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6519680c-dc56-4980-9be8-06e9c2aec087' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-905ea8cd-1ae5-44e4-b406-4275108d149c' class='xr-var-data-in' type='checkbox'><label for='data-905ea8cd-1ae5-44e4-b406-4275108d149c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[   0.        ,  294.18943955,  321.41822078, ...,  192.93331805,
         193.46556826,  192.76671589],
       [   0.        ,  432.05714374,  490.9677582 , ...,  194.84772175,
         195.06799833,  194.40459328],
       [   0.        ,  535.36374381,  619.95883018, ...,  196.12616285,
         196.21094092,  195.79399928],
       ...,
       [   0.        , 3966.56056507, 5791.89215548, ...,  205.00017796,
         211.36062787,  212.61362392],
       [   0.        , 4167.1712352 , 5456.14848464, ...,  203.8398704 ,
         205.38454854,  207.78696548],
       [   0.        , 3716.77402137, 6067.88205869, ...,  207.76466695,
         201.06258553,  200.39635905]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>A</span></div><div class='xr-var-dims'>(q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-190.0 2.585e+05 ... 19.47 20.65</div><input id='attrs-3ec89950-b338-49cd-baa9-c64e0625bf37' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3ec89950-b338-49cd-baa9-c64e0625bf37' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a69106e9-2ead-4d1a-b183-4655ef50bfdd' class='xr-var-data-in' type='checkbox'><label for='data-a69106e9-2ead-4d1a-b183-4655ef50bfdd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-1.90000000e+02,  2.58493018e+05,  1.02602346e+04,  1.15497914e+04,
        1.68195629e+04,  1.91789308e+04,  1.97920750e+04,  2.04739243e+04,
        1.98628174e+04,  2.14217457e+04,  2.30787136e+04,  2.75439244e+04,
        3.36077443e+04,  3.95384367e+04,  4.21701356e+04,  4.26722045e+04,
        4.10361202e+04,  3.58616144e+04,  2.83223278e+04,  2.06264656e+04,
        1.43607517e+04,  9.18098831e+03,  5.57030056e+03,  3.36316630e+03,
        1.93279536e+03,  1.17701023e+03,  8.05816138e+02,  6.46477276e+02,
        4.86766556e+02,  3.54100454e+02,  2.81344652e+02,  2.59050811e+02,
        2.16860258e+02,  1.66873759e+02,  1.40019053e+02,  1.08582782e+02,
        9.24025916e+01,  7.62421017e+01,  6.95296420e+01,  6.63192247e+01,
        5.82623495e+01,  5.81042089e+01,  5.24400299e+01,  4.81539029e+01,
        4.50185732e+01,  4.06202012e+01,  4.05361388e+01,  3.51453041e+01,
        3.36993461e+01,  3.35304868e+01,  3.04943557e+01,  2.94060037e+01,
        2.76688057e+01,  2.93246657e+01,  2.71957975e+01,  2.54568387e+01,
        2.55785786e+01,  2.38141133e+01,  2.40730764e+01,  2.19637827e+01,
        2.02505220e+01,  2.06261336e+01,  1.94747592e+01,  2.06536633e+01])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>B</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>190</div><input id='attrs-d79d4a1f-94c8-4bfe-b887-b9a1386c99ca' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d79d4a1f-94c8-4bfe-b887-b9a1386c99ca' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3d7d311f-de1d-41ce-b5da-2e806100ab6c' class='xr-var-data-in' type='checkbox'><label for='data-3d7d311f-de1d-41ce-b5da-2e806100ab6c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(190)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b0875d15-47f9-4ea3-8c8c-e9807a41232c' class='xr-section-summary-in' type='checkbox'  ><label for='section-b0875d15-47f9-4ea3-8c8c-e9807a41232c' class='xr-section-summary' >Attributes: <span>(18)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>model :</span></dt><dd>DDM Matrix - Single Exponential</dd><dt><span>data_to_use :</span></dt><dd>DDM Matrix</dd><dt><span>initial_params_dict :</span></dt><dd>[&quot;{&#x27;n&#x27;: 0, &#x27;value&#x27;: 100.0, &#x27;limits&#x27;: [1.0, 1000000.0], &#x27;limited&#x27;: [True, True], &#x27;fixed&#x27;: False, &#x27;parname&#x27;: &#x27;Amplitude&#x27;, &#x27;error&#x27;: 0, &#x27;step&#x27;: 0}&quot;, &quot;{&#x27;n&#x27;: 1, &#x27;value&#x27;: 1.0, &#x27;limits&#x27;: [0.001, 10.0], &#x27;limited&#x27;: [True, True], &#x27;fixed&#x27;: False, &#x27;parname&#x27;: &#x27;Tau&#x27;, &#x27;error&#x27;: 0, &#x27;step&#x27;: 0}&quot;, &quot;{&#x27;n&#x27;: 2, &#x27;value&#x27;: 190.0, &#x27;limits&#x27;: [10.0, 220.0], &#x27;limited&#x27;: [True, True], &#x27;fixed&#x27;: False, &#x27;parname&#x27;: &#x27;Background&#x27;, &#x27;error&#x27;: 0, &#x27;step&#x27;: 0}&quot;, &quot;{&#x27;n&#x27;: 3, &#x27;value&#x27;: 1.0, &#x27;limits&#x27;: [0.5, 1.1], &#x27;limited&#x27;: [True, True], &#x27;fixed&#x27;: False, &#x27;parname&#x27;: &#x27;StretchingExp&#x27;, &#x27;error&#x27;: 0, &#x27;step&#x27;: 0}&quot;]</dd><dt><span>effective_diffusion_coeff :</span></dt><dd>0.6584064996820138</dd><dt><span>tau_vs_q_slope :</span></dt><dd>[-1.89886818]</dd><dt><span>msd_alpha :</span></dt><dd>[1.053259]</dd><dt><span>msd_effective_diffusion_coeff :</span></dt><dd>[0.64391314]</dd><dt><span>diffusion_coeff :</span></dt><dd>0.6338529924342144</dd><dt><span>diffusion_coeff_std :</span></dt><dd>0.04273736278332374</dd><dt><span>velocity :</span></dt><dd>1.0717563562746923</dd><dt><span>velocity_std :</span></dt><dd>0.38768117275140707</dd><dt><span>good_q_range :</span></dt><dd>[4, 16]</dd><dt><span>DataDirectory :</span></dt><dd>C:/Users/rmcgorty/Documents/GitHub/PyDDM/Examples/</dd><dt><span>FileName :</span></dt><dd>images_nobin_40x_128x128_8bit.tif</dd><dt><span>pixel_size :</span></dt><dd>0.242</dd><dt><span>frame_rate :</span></dt><dd>41.7</dd><dt><span>BackgroundMethod :</span></dt><dd>None</dd><dt><span>OverlapMethod :</span></dt><dd>2</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_46_1.png" src="_images/Walkthrough_-_details_46_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_46_2.png" src="_images/Walkthrough_-_details_46_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_46_3.png" src="_images/Walkthrough_-_details_46_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_46_4.png" src="_images/Walkthrough_-_details_46_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_46_5.png" src="_images/Walkthrough_-_details_46_5.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_46_6.png" src="_images/Walkthrough_-_details_46_6.png" />
</div>
</div>
<p>It doesn’t appear that that helped much. In fact, we see that the <span class="math notranslate nohighlight">\(\tau\)</span> values appear to be “hitting the rails” of the bounds we imposed on the parameter.</p>
<p>Below, we plot <span class="math notranslate nohighlight">\(\tau\)</span> vs <span class="math notranslate nohighlight">\(q\)</span> for the last two fittings. We see that updating the initial guess didn’t improve things. So the reason that the <span class="math notranslate nohighlight">\(\tau\)</span> found for the high wavevectors is off does not seem to be related to the fitting algorithm using a poor initial guess. Perhaps at the high wavevectors the dynamics are too fast for us detect with the camera frame rate we used? Below we also plot a horizontal line corresponding the time interval between frames. We see that the fits
are off even well above our temporal resolution. So it is also not the case that the fits at some of the high wavevectors is due to poor temporal resolution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">################################################################################################</span>
<span class="c1"># Plotting the characteristic decay time tau vs wavevector q determined from the last two fits #</span>
<span class="c1">################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">/</span><span class="mf">1.618</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">fit01</span><span class="o">.</span><span class="n">q</span><span class="p">,</span> <span class="n">fit01</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Tau&#39;</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Not updating tau&#39;s initial guess&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">fit02</span><span class="o">.</span><span class="n">q</span><span class="p">,</span> <span class="n">fit02</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Tau&#39;</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Updating tau&#39;s initial guess based on estimated diffusion coeff&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">fit01</span><span class="o">.</span><span class="n">frame_rate</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x229a892e760&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_49_1.png" src="_images/Walkthrough_-_details_49_1.png" />
</div>
</div>
</section>
<section id="Our-third-attemp-at-fitting-the-data---tightening-the-bounds-on-the-stretching-exponent">
<h3>Our third attemp at fitting the data - tightening the bounds on the stretching exponent<a class="headerlink" href="#Our-third-attemp-at-fitting-the-data---tightening-the-bounds-on-the-stretching-exponent" title="Link to this heading">#</a></h3>
<p>Let’s try one more thing with this fitting. Let’s think about the stretching exponent. For normal diffusive motion, we expect the intermediate scattering function to be a simple exponential: <span class="math notranslate nohighlight">\(f(q,\Delta t) = \exp(-\Delta t / \tau)\)</span>. But sometimes when the dynamics are heterogeneous or subdiffusion is present, we see that a stretched exponential works better. That is, for the ISF we use: <span class="math notranslate nohighlight">\(f(q,\Delta t) = \exp(-\Delta t / \tau)^s\)</span> where <span class="math notranslate nohighlight">\(s\)</span> is the stretching exponent.</p>
<p>For this example data, we just have movie of silica colloidal particles diffusing in water. The dynamics should be diffusive. So we could try constraining the stretching exponent to be around to 1 as we expect (notice how the stretching exponent is between 0.6 and 0.7 for the high <span class="math notranslate nohighlight">\(q\)</span> values in the previous fits).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#We update the intial guess for the background and the lower and upper bounds</span>
<span class="n">ddm_fit</span><span class="o">.</span><span class="n">set_parameter_initial_guess</span><span class="p">(</span><span class="s1">&#39;StretchingExp&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ddm_fit</span><span class="o">.</span><span class="n">set_parameter_bounds</span><span class="p">(</span><span class="s1">&#39;StretchingExp&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.85</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Parameter &#39;StretchingExp&#39; set to 1.
Parameter &#39;StretchingExp&#39; lower limit set to 0.85.
Parameter &#39;StretchingExp&#39; upper limit set to 1.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit03</span> <span class="o">=</span> <span class="n">ddm_fit</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">name_fit</span> <span class="o">=</span> <span class="s1">&#39;fit03&#39;</span><span class="p">,</span> <span class="n">display_table</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_A_from_images_as_guess</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_limits_on_A</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">update_tau_based_on_estimated_diffcoeff</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">estimated_diffcoeff</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                   <span class="n">update_limits_on_tau</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">updated_lims_on_tau_fraction</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
In function &#39;get_tau_vs_q_fit&#39;, using new tau...
Fit is saved in fittings dictionary with key &#39;fit03&#39;.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddm</span><span class="o">.</span><span class="n">fit_report</span><span class="p">(</span><span class="n">fit03</span><span class="p">,</span> <span class="n">q_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">22</span><span class="p">],</span> <span class="n">forced_qs</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span> <span class="n">use_new_tau</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:          (parameter: 4, q: 64, lagtime: 40)
Coordinates:
  * parameter        (parameter) &lt;U13 &#x27;Amplitude&#x27; &#x27;Tau&#x27; ... &#x27;StretchingExp&#x27;
  * q                (q) float64 0.0 0.2028 0.4057 0.6085 ... 12.37 12.58 12.78
  * lagtime          (lagtime) float64 0.02398 0.04796 0.07194 ... 12.59 14.36
Data variables:
    parameters       (parameter, q) float64 1.0 2.326e+05 ... 0.85 0.85
    theory           (lagtime, q) float64 10.0 78.85 304.9 ... 200.8 200.6 200.4
    isf_data         (lagtime, q) float64 0.0 0.9996 0.9872 ... 0.432 0.4966
    ddm_matrix_data  (lagtime, q) float64 0.0 294.2 321.4 ... 207.8 201.1 200.4
    A                (q) float64 -190.0 2.585e+05 1.026e+04 ... 19.47 20.65
    B                int32 190
Attributes: (12/18)
    model:                          DDM Matrix - Single Exponential
    data_to_use:                    DDM Matrix
    initial_params_dict:            [&quot;{&#x27;n&#x27;: 0, &#x27;value&#x27;: 100.0, &#x27;limits&#x27;: [1.0...
    effective_diffusion_coeff:      0.6779463827208101
    tau_vs_q_slope:                 [-1.84532034]
    msd_alpha:                      [1.08382266]
    ...                             ...
    DataDirectory:                  C:/Users/rmcgorty/Documents/GitHub/PyDDM/...
    FileName:                       images_nobin_40x_128x128_8bit.tif
    pixel_size:                     0.242
    frame_rate:                     41.7
    BackgroundMethod:               None
    OverlapMethod:                  2</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-59032ed1-58f8-464f-b9de-47af87c3adf2' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-59032ed1-58f8-464f-b9de-47af87c3adf2' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>parameter</span>: 4</li><li><span class='xr-has-index'>q</span>: 64</li><li><span class='xr-has-index'>lagtime</span>: 40</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-205c3d45-58dc-4bf5-b406-a86a98e00686' class='xr-section-summary-in' type='checkbox'  checked><label for='section-205c3d45-58dc-4bf5-b406-a86a98e00686' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>parameter</span></div><div class='xr-var-dims'>(parameter)</div><div class='xr-var-dtype'>&lt;U13</div><div class='xr-var-preview xr-preview'>&#x27;Amplitude&#x27; ... &#x27;StretchingExp&#x27;</div><input id='attrs-5566f43b-d646-4e7b-8adf-119d7adc5aad' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5566f43b-d646-4e7b-8adf-119d7adc5aad' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3aa53ab7-d939-4f9b-87a1-8f0279f4c5e4' class='xr-var-data-in' type='checkbox'><label for='data-3aa53ab7-d939-4f9b-87a1-8f0279f4c5e4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;Amplitude&#x27;, &#x27;Tau&#x27;, &#x27;Background&#x27;, &#x27;StretchingExp&#x27;], dtype=&#x27;&lt;U13&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>q</span></div><div class='xr-var-dims'>(q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.2028 0.4057 ... 12.58 12.78</div><input id='attrs-78c6895a-fb0c-4300-b2ad-8c666bd75554' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-78c6895a-fb0c-4300-b2ad-8c666bd75554' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-074c6144-cfd3-4aa8-b1b2-43e20b12b760' class='xr-var-data-in' type='checkbox'><label for='data-074c6144-cfd3-4aa8-b1b2-43e20b12b760' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0.      ,  0.20284 ,  0.405681,  0.608521,  0.811362,  1.014202,
        1.217043,  1.419883,  1.622723,  1.825564,  2.028404,  2.231245,
        2.434085,  2.636926,  2.839766,  3.042607,  3.245447,  3.448287,
        3.651128,  3.853968,  4.056809,  4.259649,  4.46249 ,  4.66533 ,
        4.86817 ,  5.071011,  5.273851,  5.476692,  5.679532,  5.882373,
        6.085213,  6.288053,  6.490894,  6.693734,  6.896575,  7.099415,
        7.302256,  7.505096,  7.707937,  7.910777,  8.113617,  8.316458,
        8.519298,  8.722139,  8.924979,  9.12782 ,  9.33066 ,  9.5335  ,
        9.736341,  9.939181, 10.142022, 10.344862, 10.547703, 10.750543,
       10.953383, 11.156224, 11.359064, 11.561905, 11.764745, 11.967586,
       12.170426, 12.373267, 12.576107, 12.778947])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lagtime</span></div><div class='xr-var-dims'>(lagtime)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02398 0.04796 ... 12.59 14.36</div><input id='attrs-af57747d-cc9f-477d-8fba-cf9710c60366' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-af57747d-cc9f-477d-8fba-cf9710c60366' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-29269d2a-c3b5-42fd-8814-f41187bf8279' class='xr-var-data-in' type='checkbox'><label for='data-29269d2a-c3b5-42fd-8814-f41187bf8279' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0.023981,  0.047962,  0.071942,  0.095923,  0.119904,  0.143885,
        0.167866,  0.191847,  0.215827,  0.263789,  0.28777 ,  0.335731,
        0.383693,  0.431655,  0.503597,  0.57554 ,  0.647482,  0.743405,
        0.863309,  0.983213,  1.127098,  1.294964,  1.486811,  1.702638,
        1.942446,  2.206235,  2.541966,  2.901679,  3.309353,  3.788969,
        4.316547,  4.940048,  5.659472,  6.450839,  7.386091,  8.441247,
        9.640288, 11.007194, 12.589928, 14.364508])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-979b3b07-7688-4724-9bc1-397e09436ce9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-979b3b07-7688-4724-9bc1-397e09436ce9' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>parameters</span></div><div class='xr-var-dims'>(parameter, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 2.326e+05 ... 0.85 0.85</div><input id='attrs-bf2a0a96-ecef-44cc-83e1-9a3860981b48' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bf2a0a96-ecef-44cc-83e1-9a3860981b48' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cf7f2caa-a59c-4ee3-82c0-cf15e8393f3c' class='xr-var-data-in' type='checkbox'><label for='data-cf7f2caa-a59c-4ee3-82c0-cf15e8393f3c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1.00000000e+00, 2.32643716e+05, 9.23421116e+03, 1.03948122e+04,
        1.60003202e+04, 1.87741628e+04, 2.01262090e+04, 2.02699354e+04,
        1.93938140e+04, 2.14281346e+04, 2.33743043e+04, 2.75572551e+04,
        3.35948001e+04, 3.99229074e+04, 4.20968490e+04, 4.23743650e+04,
        4.11720321e+04, 3.60354402e+04, 2.86662660e+04, 2.08140281e+04,
        1.44536527e+04, 9.32711827e+03, 5.66146702e+03, 3.47725293e+03,
        2.06716941e+03, 1.22311562e+03, 8.76927279e+02, 6.90124549e+02,
        5.11753536e+02, 3.71791825e+02, 2.92071418e+02, 2.62261447e+02,
        2.25300404e+02, 1.74720965e+02, 1.45416169e+02, 1.10732817e+02,
        9.10226873e+01, 7.62810056e+01, 6.92047238e+01, 6.19430712e+01,
        5.66532390e+01, 5.56754998e+01, 4.99486147e+01, 4.76357944e+01,
        4.62577150e+01, 4.13242391e+01, 4.33182867e+01, 3.73441604e+01,
        3.70692807e+01, 3.68835355e+01, 3.34116359e+01, 3.23466041e+01,
        3.04356863e+01, 3.22571323e+01, 2.99153772e+01, 2.80025225e+01,
        2.81364364e+01, 2.61955246e+01, 2.64803840e+01, 2.41601609e+01,
        2.22755742e+01, 2.26887470e+01, 2.14222352e+01, 2.27190297e+01],
       [1.00000000e+01, 8.10157916e+01, 5.93151055e+00, 3.19823267e+00,
        2.35940287e+00, 1.42436451e+00, 1.03553609e+00, 7.42218947e-01,
        5.52015439e-01, 4.65091456e-01, 3.96220605e-01, 3.24285752e-01,
        2.94651560e-01, 2.56813354e-01, 2.18980700e-01, 1.97344828e-01,
...
        1.74181629e+02, 1.73699760e+02, 1.75872232e+02, 1.75672665e+02,
        1.76717670e+02, 1.74420790e+02, 1.75377440e+02, 1.76123228e+02,
        1.75933358e+02, 1.76915945e+02, 1.76883833e+02, 1.78261549e+02,
        1.78758553e+02, 1.78116378e+02, 1.79162804e+02, 1.77708018e+02],
       [1.00000000e+00, 1.00000000e+00, 8.50000000e-01, 8.50000000e-01,
        8.50000000e-01, 9.09132557e-01, 9.11750622e-01, 9.52912603e-01,
        9.57434031e-01, 9.79312823e-01, 9.69590609e-01, 1.00000000e+00,
        1.00000000e+00, 1.00000000e+00, 1.00000000e+00, 1.00000000e+00,
        1.00000000e+00, 1.00000000e+00, 1.00000000e+00, 1.00000000e+00,
        1.00000000e+00, 1.00000000e+00, 1.00000000e+00, 9.75980335e-01,
        9.19591679e-01, 9.11770112e-01, 8.60156233e-01, 8.59200975e-01,
        8.50000000e-01, 8.50000000e-01, 8.50000000e-01, 8.50000000e-01,
        8.50000000e-01, 8.50000000e-01, 8.50000000e-01, 8.50000000e-01,
        8.50000000e-01, 8.50000000e-01, 8.50000000e-01, 8.50000000e-01,
        8.50000000e-01, 8.50000000e-01, 8.50000000e-01, 8.50000000e-01,
        8.50000000e-01, 8.50000000e-01, 8.50000000e-01, 8.50000000e-01,
        8.50000000e-01, 8.50000000e-01, 8.50000000e-01, 8.50000000e-01,
        8.50000000e-01, 8.50000000e-01, 8.50000000e-01, 8.50000000e-01,
        8.50000000e-01, 8.50000000e-01, 8.50000000e-01, 8.50000000e-01,
        8.50000000e-01, 8.50000000e-01, 8.50000000e-01, 8.50000000e-01]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>theory</span></div><div class='xr-var-dims'>(lagtime, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>10.0 78.85 304.9 ... 200.6 200.4</div><input id='attrs-2700783d-0e46-4d4b-9921-5ab6db2a62f8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2700783d-0e46-4d4b-9921-5ab6db2a62f8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-306c19cd-1c8b-4cc9-bb63-78d4e3d8c4be' class='xr-var-data-in' type='checkbox'><label for='data-306c19cd-1c8b-4cc9-bb63-78d4e3d8c4be' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1.00023952e+01, 7.88527542e+01, 3.04935382e+02, ...,
        1.93142984e+02, 1.93567415e+02, 1.93210146e+02],
       [1.00047847e+01, 1.47685131e+02, 3.72530736e+02, ...,
        1.97598835e+02, 1.97719290e+02, 1.97551808e+02],
       [1.00071684e+01, 2.16497136e+02, 4.34561426e+02, ...,
        1.99371895e+02, 1.99332618e+02, 1.99198835e+02],
       ...,
       [1.06673683e+01, 2.95649066e+04, 7.75262515e+03, ...,
        2.00805125e+02, 2.00585039e+02, 2.00427047e+02],
       [1.07160601e+01, 3.34939686e+04, 8.06747230e+03, ...,
        2.00805125e+02, 2.00585039e+02, 2.00427047e+02],
       [1.07622299e+01, 3.78089588e+04, 8.34673758e+03, ...,
        2.00805125e+02, 2.00585039e+02, 2.00427047e+02]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>isf_data</span></div><div class='xr-var-dims'>(lagtime, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.9996 0.9872 ... 0.432 0.4966</div><input id='attrs-8fdc5275-da7a-4a6e-bc64-fcc06dc4aacb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8fdc5275-da7a-4a6e-bc64-fcc06dc4aacb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6c638b3e-9689-435e-a69d-e93756a77205' class='xr-var-data-in' type='checkbox'><label for='data-6c638b3e-9689-435e-a69d-e93756a77205' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 0.        ,  0.99959694,  0.9871915 , ...,  0.85778634,
         0.82204821,  0.86604236],
       [ 0.        ,  0.99906358,  0.97066658, ...,  0.76497186,
         0.7397658 ,  0.78674034],
       [ 0.        ,  0.99866393,  0.95809464, ...,  0.70299025,
         0.6810774 ,  0.71946869],
       ...,
       [ 0.        ,  0.98539009,  0.4540191 , ...,  0.27275862,
        -0.09683656, -0.09489651],
       [ 0.        ,  0.98461401,  0.4867419 , ...,  0.32901286,
         0.21002625,  0.13879852],
       [ 0.        ,  0.98635641,  0.42712011, ...,  0.13873015,
         0.43195264,  0.49663365]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ddm_matrix_data</span></div><div class='xr-var-dims'>(lagtime, q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 294.2 321.4 ... 201.1 200.4</div><input id='attrs-db5d43d0-a76e-408c-96f9-5c44a25dd695' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-db5d43d0-a76e-408c-96f9-5c44a25dd695' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-366b6d60-5a27-420e-8c3d-e8217e2bcaa8' class='xr-var-data-in' type='checkbox'><label for='data-366b6d60-5a27-420e-8c3d-e8217e2bcaa8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[   0.        ,  294.18943955,  321.41822078, ...,  192.93331805,
         193.46556826,  192.76671589],
       [   0.        ,  432.05714374,  490.9677582 , ...,  194.84772175,
         195.06799833,  194.40459328],
       [   0.        ,  535.36374381,  619.95883018, ...,  196.12616285,
         196.21094092,  195.79399928],
       ...,
       [   0.        , 3966.56056507, 5791.89215548, ...,  205.00017796,
         211.36062787,  212.61362392],
       [   0.        , 4167.1712352 , 5456.14848464, ...,  203.8398704 ,
         205.38454854,  207.78696548],
       [   0.        , 3716.77402137, 6067.88205869, ...,  207.76466695,
         201.06258553,  200.39635905]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>A</span></div><div class='xr-var-dims'>(q)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-190.0 2.585e+05 ... 19.47 20.65</div><input id='attrs-7bf5cfee-290b-4783-b0ca-eca8cc250487' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7bf5cfee-290b-4783-b0ca-eca8cc250487' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12250277-1efc-4428-ae96-1519d2bda41d' class='xr-var-data-in' type='checkbox'><label for='data-12250277-1efc-4428-ae96-1519d2bda41d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-1.90000000e+02,  2.58493018e+05,  1.02602346e+04,  1.15497914e+04,
        1.68195629e+04,  1.91789308e+04,  1.97920750e+04,  2.04739243e+04,
        1.98628174e+04,  2.14217457e+04,  2.30787136e+04,  2.75439244e+04,
        3.36077443e+04,  3.95384367e+04,  4.21701356e+04,  4.26722045e+04,
        4.10361202e+04,  3.58616144e+04,  2.83223278e+04,  2.06264656e+04,
        1.43607517e+04,  9.18098831e+03,  5.57030056e+03,  3.36316630e+03,
        1.93279536e+03,  1.17701023e+03,  8.05816138e+02,  6.46477276e+02,
        4.86766556e+02,  3.54100454e+02,  2.81344652e+02,  2.59050811e+02,
        2.16860258e+02,  1.66873759e+02,  1.40019053e+02,  1.08582782e+02,
        9.24025916e+01,  7.62421017e+01,  6.95296420e+01,  6.63192247e+01,
        5.82623495e+01,  5.81042089e+01,  5.24400299e+01,  4.81539029e+01,
        4.50185732e+01,  4.06202012e+01,  4.05361388e+01,  3.51453041e+01,
        3.36993461e+01,  3.35304868e+01,  3.04943557e+01,  2.94060037e+01,
        2.76688057e+01,  2.93246657e+01,  2.71957975e+01,  2.54568387e+01,
        2.55785786e+01,  2.38141133e+01,  2.40730764e+01,  2.19637827e+01,
        2.02505220e+01,  2.06261336e+01,  1.94747592e+01,  2.06536633e+01])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>B</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>190</div><input id='attrs-b10d32b7-3a03-4e5e-a133-2ccceede1c73' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b10d32b7-3a03-4e5e-a133-2ccceede1c73' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-054c5beb-23d5-4086-acf7-9658146c53f2' class='xr-var-data-in' type='checkbox'><label for='data-054c5beb-23d5-4086-acf7-9658146c53f2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(190)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-50ae7a65-fa80-4d22-b5b2-eedfe428229d' class='xr-section-summary-in' type='checkbox'  ><label for='section-50ae7a65-fa80-4d22-b5b2-eedfe428229d' class='xr-section-summary' >Attributes: <span>(18)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>model :</span></dt><dd>DDM Matrix - Single Exponential</dd><dt><span>data_to_use :</span></dt><dd>DDM Matrix</dd><dt><span>initial_params_dict :</span></dt><dd>[&quot;{&#x27;n&#x27;: 0, &#x27;value&#x27;: 100.0, &#x27;limits&#x27;: [1.0, 1000000.0], &#x27;limited&#x27;: [True, True], &#x27;fixed&#x27;: False, &#x27;parname&#x27;: &#x27;Amplitude&#x27;, &#x27;error&#x27;: 0, &#x27;step&#x27;: 0}&quot;, &quot;{&#x27;n&#x27;: 1, &#x27;value&#x27;: 1.0, &#x27;limits&#x27;: [0.001, 10.0], &#x27;limited&#x27;: [True, True], &#x27;fixed&#x27;: False, &#x27;parname&#x27;: &#x27;Tau&#x27;, &#x27;error&#x27;: 0, &#x27;step&#x27;: 0}&quot;, &quot;{&#x27;n&#x27;: 2, &#x27;value&#x27;: 190.0, &#x27;limits&#x27;: [10.0, 220.0], &#x27;limited&#x27;: [True, True], &#x27;fixed&#x27;: False, &#x27;parname&#x27;: &#x27;Background&#x27;, &#x27;error&#x27;: 0, &#x27;step&#x27;: 0}&quot;, &quot;{&#x27;n&#x27;: 3, &#x27;value&#x27;: 1.0, &#x27;limits&#x27;: [0.85, 1.0], &#x27;limited&#x27;: [True, True], &#x27;fixed&#x27;: False, &#x27;parname&#x27;: &#x27;StretchingExp&#x27;, &#x27;error&#x27;: 0, &#x27;step&#x27;: 0}&quot;]</dd><dt><span>effective_diffusion_coeff :</span></dt><dd>0.6779463827208101</dd><dt><span>tau_vs_q_slope :</span></dt><dd>[-1.84532034]</dd><dt><span>msd_alpha :</span></dt><dd>[1.08382266]</dd><dt><span>msd_effective_diffusion_coeff :</span></dt><dd>[0.6562143]</dd><dt><span>diffusion_coeff :</span></dt><dd>0.6463363023540297</dd><dt><span>diffusion_coeff_std :</span></dt><dd>0.07295135160177549</dd><dt><span>velocity :</span></dt><dd>1.0725254218902054</dd><dt><span>velocity_std :</span></dt><dd>0.35877065376614453</dd><dt><span>good_q_range :</span></dt><dd>[4, 16]</dd><dt><span>DataDirectory :</span></dt><dd>C:/Users/rmcgorty/Documents/GitHub/PyDDM/Examples/</dd><dt><span>FileName :</span></dt><dd>images_nobin_40x_128x128_8bit.tif</dd><dt><span>pixel_size :</span></dt><dd>0.242</dd><dt><span>frame_rate :</span></dt><dd>41.7</dd><dt><span>BackgroundMethod :</span></dt><dd>None</dd><dt><span>OverlapMethod :</span></dt><dd>2</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_54_1.png" src="_images/Walkthrough_-_details_54_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_54_2.png" src="_images/Walkthrough_-_details_54_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_54_3.png" src="_images/Walkthrough_-_details_54_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_54_4.png" src="_images/Walkthrough_-_details_54_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_54_5.png" src="_images/Walkthrough_-_details_54_5.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_54_6.png" src="_images/Walkthrough_-_details_54_6.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##################################################################################################</span>
<span class="c1"># Plotting the characteristic decay time tau vs wavevector q determined from the last three fits #</span>
<span class="c1">##################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">/</span><span class="mf">1.618</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">fit01</span><span class="o">.</span><span class="n">q</span><span class="p">,</span> <span class="n">fit01</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Tau&#39;</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Not updating tau&#39;s initial guess&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">fit02</span><span class="o">.</span><span class="n">q</span><span class="p">,</span> <span class="n">fit02</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Tau&#39;</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Updating tau&#39;s initial guess&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">fit03</span><span class="o">.</span><span class="n">q</span><span class="p">,</span> <span class="n">fit03</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Tau&#39;</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Restricting the stretching exponent&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$q$ ($\mu$m$^{-1})$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Decay time, $</span><span class="se">\\</span><span class="s2">tau$ (s)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">fit01</span><span class="o">.</span><span class="n">frame_rate</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x229a6934640&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_55_1.png" src="_images/Walkthrough_-_details_55_1.png" />
</div>
</div>
</section>
<section id="What-to-make-of-the-results-at-high-q">
<h3>What to make of the results at high <span class="math notranslate nohighlight">\(q\)</span><a class="headerlink" href="#What-to-make-of-the-results-at-high-q" title="Link to this heading">#</a></h3>
<p>So we have tried a couple things to improve the results of our fits for <span class="math notranslate nohighlight">\(q \gtrsim 6 \mu m^{-1}\)</span>. We tried:</p>
<ol class="arabic simple">
<li><p>Updating the intial guess for <span class="math notranslate nohighlight">\(\tau\)</span> for each <span class="math notranslate nohighlight">\(q\)</span> based on an expected diffusion coefficient and constraining the bounds of <span class="math notranslate nohighlight">\(\tau\)</span> around that guess.</p></li>
<li><p>Narrowing the bounds of the stretching exponent to be close to what we would expect for normal diffusive motion (i.e., near 1).</p></li>
</ol>
<p>But, these didn’t seem to make the result for <span class="math notranslate nohighlight">\(\tau (q)\)</span> reasonable for the larger <span class="math notranslate nohighlight">\(q\)</span> values. So what is going on?</p>
<p>The horizontal line in the plot above corresponds to the minimum time lag we are measuring (24 ms given our frame rate of 41.7 Hz). So we are not lacking in temporal resolution.</p>
<p>But what about <strong>spatial resolution</strong>? Even though our pixels are 0.242 <span class="math notranslate nohighlight">\(\mu m\)</span> in size doesn’t mean that we can truly measure dynamics occurring around such small length scales.</p>
<p>The data used here was acquired using a not-so-great microscope with a 40x 0.5NA objective and a 0.3NA condenser. Assuming light of a wavelength of 550 nm, that means our theoretical resolution is <span class="math notranslate nohighlight">\(\frac{1.22 \times 0.550}{0.5+0.3} = 0.763 \mu m\)</span>. Note that this is more than 3 times the pixel size.</p>
<p>As described in [<strong>Safari 2015</strong>], the maximum <span class="math notranslate nohighlight">\(q\)</span> is determined either by (1) the pixel size, (2) the smallest distance a particle can be detected moving between two frames given the frame rate, and (3) the smallest resolvable distance given the optical resolution limit. In the case of (3): <span class="math notranslate nohighlight">\(q_{max} = \frac{2 \pi NA}{\lambda}\)</span>. For our data, that would be <span class="math notranslate nohighlight">\(q_{max} = 5.7 \mu m^{-1}\)</span>.</p>
<p><strong>So it seems we have found the culprit of the poor fitting at large :math:`q`: our limited optical resolution.</strong></p>
<blockquote>
<div><p>[<strong>Safari 2015</strong>] Safari, M. S., Vorontsova, M. A., Poling-Skutvik, R., Vekilov, P. G. &amp; Conrad, J. C. <a class="reference external" href="https://doi.org/10.1103/PhysRevE.92.042712">Differential dynamic microscopy of weakly scattering and polydisperse protein-rich clusters.</a> Phys. Rev. E 92, 042712 (2015).</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##################################################################################################</span>
<span class="c1"># Plotting the characteristic decay time tau vs wavevector q determined from the last three fits #</span>
<span class="c1">##################################################################################################</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">/</span><span class="mf">1.618</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">fit01</span><span class="o">.</span><span class="n">q</span><span class="p">,</span> <span class="n">fit01</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Tau&#39;</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Not updating tau&#39;s initial guess&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">fit02</span><span class="o">.</span><span class="n">q</span><span class="p">,</span> <span class="n">fit02</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Tau&#39;</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Updating tau&#39;s initial guess&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">fit03</span><span class="o">.</span><span class="n">q</span><span class="p">,</span> <span class="n">fit03</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Tau&#39;</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Restricting the stretching exponent&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$q$ ($\mu$m$^{-1})$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Decay time, $</span><span class="se">\\</span><span class="s2">tau$ (s)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">fit01</span><span class="o">.</span><span class="n">frame_rate</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mf">5.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Lines correspond roughly to limits of temporal (horizontal line) and spatial (vertical line) resolution&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Lines correspond roughly to limits of temporal (horizontal line) and spatial (vertical line) resolution&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_58_1.png" src="_images/Walkthrough_-_details_58_1.png" />
</div>
</div>
</section>
</section>
<section id="Determining-the-mean-squared-displacement-from-the-ISF">
<h2>Determining the mean squared displacement from the ISF<a class="headerlink" href="#Determining-the-mean-squared-displacement-from-the-ISF" title="Link to this heading">#</a></h2>
<p>If we assume that the particle displacements are Gaussian, then the ISF can be written as <span class="math notranslate nohighlight">\(f(q,\Delta t) = \exp \left[ (-q^2 / 4) \left&lt; \Delta r^2(\Delta t) \right&gt; \right]\)</span>. We can then find the MSD, <span class="math notranslate nohighlight">\(\left&lt; \Delta r^2(\Delta t) \right&gt;\)</span> from the DDM matrix, <span class="math notranslate nohighlight">\(D(q, \Delta t)\)</span>, using:</p>
<div class="math notranslate nohighlight">
\[\left&lt; \Delta r^2(\Delta t) \right&gt; = \frac{4}{q^2} \ln \left[ \frac{A(q)}{A(q)-D(q,\Delta t)+B(q)} \right]\]</div>
<p>See equation 6 in [<strong>Bayles 2017</strong>] or equation 7 in [<strong>Edera 2017</strong>].</p>
<p>We find <span class="math notranslate nohighlight">\(\left&lt; \Delta r^2(\Delta t) \right&gt;\)</span> in this code with the method <code class="docutils literal notranslate"><span class="pre">extract_MSD</span></code> in the <code class="docutils literal notranslate"><span class="pre">DDM_Fit</span></code> class. The code will use the <em>‘Amplitude’</em> and <em>‘Background’</em> parameters of the fit. But, if those parameters are not present (as would be the case if we fit to the ISF instead of the DDM matrix) then the code will use the estimate for <span class="math notranslate nohighlight">\(A(q)\)</span> and <span class="math notranslate nohighlight">\(B\)</span> found using <span class="math notranslate nohighlight">\(\left&lt; | \tilde{I}(q, t) |^2 \right&gt;_t\)</span> as described previously in this document.</p>
<blockquote>
<div><p>[<strong>Bayles 2017</strong>] Bayles, A. V., Squires, T. M. &amp; Helgeson, M. E. <a class="reference external" href="https://doi.org/10.1007/s00397-017-1047-7">Probe microrheology without particle tracking by differential dynamic microscopy.</a> Rheol Acta 56, 863–869 (2017).</p>
</div></blockquote>
<blockquote>
<div><p>[<strong>Edera 2017</strong>] Edera, P., Bergamini, D., Trappe, V., Giavazzi, F. &amp; Cerbino, R. <a class="reference external" href="https://doi.org/10.1103/PhysRevMaterials.1.073804">Differential dynamic microscopy microrheology of soft materials: A tracking-free determination of the frequency-dependent loss and storage moduli.</a> Phys. Rev. Materials 1, 073804 (2017).</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################################</span>
<span class="c1"># Plotting the mean squared displacement as a function of lag time as determined from the ISF #</span>
<span class="c1">###############################################################################################</span>

<span class="n">msd</span><span class="p">,</span> <span class="n">msd_std</span> <span class="o">=</span> <span class="n">ddm_fit</span><span class="o">.</span><span class="n">extract_MSD</span><span class="p">(</span><span class="n">fit</span><span class="o">=</span><span class="n">fit01</span><span class="p">)</span>
<span class="n">poly_fit_results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">msd</span><span class="o">.</span><span class="n">lagtime</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">msd</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">msd</span><span class="o">.</span><span class="n">lagtime</span><span class="p">,</span> <span class="n">msd</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">msd</span><span class="o">.</span><span class="n">lagtime</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">poly_fit_results</span><span class="p">,</span><span class="n">msd</span><span class="o">.</span><span class="n">lagtime</span><span class="p">),</span> <span class="s1">&#39;-r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Lag time (s)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;MSD ($\mu$m$^2$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;MSD vs lag time&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Diffusion coefficient: </span><span class="si">%.5f</span><span class="s2"> um^2/s&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">poly_fit_results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">4.</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\Users\rmcgorty\Anaconda3\lib\site-packages\xarray\core\computation.py:742: RuntimeWarning: invalid value encountered in log
  result_data = func(*input_data)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Diffusion coefficient: 0.66499 um^2/s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Walkthrough_-_details_61_2.png" src="_images/Walkthrough_-_details_61_2.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Walkthrough%20-%20simple.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Simple walkthrough</p>
      </div>
    </a>
    <a class="right-next"
       href="Walkthrough%20-%20creating%20a%20new%20DDM%20fitting%20function.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Creating a new DDM fitting function</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Importing-the-necessary-modules">Importing the necessary modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Initializing-DDM_Analysis-class-and-computing-the-DDM-matrix">Initializing DDM_Analysis class and computing the DDM matrix</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Digging-into-the-DDM-xarray.Dataset">Digging into the DDM xarray.Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Different-data-selecting-methods">Different data selecting methods</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Determing-the-A-and-B-parameters-to-get-the-ISF">Determing the A and B parameters to get the ISF</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Checking-the-background-estimate">Checking the background estimate</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Additional-notes-about-the-background">Additional notes about the background</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Initiazing-DDM_Fit-class-and-fitting-our-data-to-a-model">Initiazing DDM_Fit class and fitting our data to a model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Our-first-attemp-at-fitting-the-data">Our first attemp at fitting the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Our-second-attemp-at-fitting-the-data---updating-initial-guesses-for-tau">Our second attemp at fitting the data - updating initial guesses for tau</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Our-third-attemp-at-fitting-the-data---tightening-the-bounds-on-the-stretching-exponent">Our third attemp at fitting the data - tightening the bounds on the stretching exponent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#What-to-make-of-the-results-at-high-q">What to make of the results at high <span class="math notranslate nohighlight">\(q\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Determining-the-mean-squared-displacement-from-the-ISF">Determining the mean squared displacement from the ISF</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ryan McGorty and Hannah Noor Verwei
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2021, Ryan McGorty and Hannah Noor Verwei.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>